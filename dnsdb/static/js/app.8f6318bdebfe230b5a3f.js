webpackJsonp([1],[,,,,function(e,t,a){"use strict";function n(e){var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.href);return null===t?null:t[1]||0}function i(e){var t={};for(var a in e)t[a]="object"===l()(e[a])?i(e[a]):e[a];return t}var o=a(26),s=a.n(o),r=a(18),l=a.n(r),c=a(226),d=a.n(c),u=function(e,t,a,n){e.$confirm(t,"确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a(n)}).catch(function(){})},p=function(e,t,a,n){n||(n="success"),e.$notify({title:t,message:a,type:n,duration:1500})},f=function(e,t){var a=d.a.merge({url:"",data:null,succ:function(t){e.$notify.success({title:"成功",message:"API调用成功",duration:1500})},fail:function(t){if(401===t.errcode)return void e.$router.push("/login");e.$notify.error({title:"获取数据失败",message:t.message,duration:1500})}},t);e.$http.get(a.url,{params:a.data}).then(function(e){0!==e.data.errcode?a.fail(e.data):a.succ(e.data)}).catch(function(t){if(401===t.status)return void e.$router.push("/login");e.$notify.error({title:"异常",message:"状态码:"+t.status,duration:1500})})},m=function(e,t){var a=d.a.merge({url:"",data:null,succStr:"API调用成功",succ:function(t){e.$notify.success({title:"成功",message:a.succStr,duration:1500})},fail:function(t){if(401===t.errcode)return void e.$router.push("/login");e.$confirm(t.message+"，请检查后重试","失败",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){}).catch(function(){})}},t);e.$http.post(a.url,a.data).then(function(e){0!==e.data.errcode?a.fail(e.data):a.succ(e.data)}).catch(function(t){if(console.log(t),401===t.status)return void e.$router.push("/login");e.$notify.error({title:"异常",message:"状态码:"+t.status,duration:1500})})},h=function(e,t){console.log(t),e[t]=e[t].trim()},v=function(e){var t=[];for(var a in e){var n={};n.label=e[a],n.value=e[a],t.push(n)}return t},g=function(e){var t=[];for(var a in e){var n={};n.label=e[a],n.value=a,t.push(n)}return t},_=function(e,t,a){var n=[];for(var i in e){var o={};o.label=e[i][t],o.value=e[i][a],n.push(o)}return n},b=function(e){return/^[0-9A-Fa-f]{1,4}$/.test(e)},y=function(e){e=e.trim();var t=e.indexOf("::");if(t<0){var a=e.split(":");if(8!==a.length)return!1;var n=!0,i=!1,o=void 0;try{for(var r,l=s()(a);!(n=(r=l.next()).done);n=!0){var c=r.value;if(!b(c))return!1}}catch(e){i=!0,o=e}finally{try{!n&&l.return&&l.return()}finally{if(i)throw o}}return!0}if(t!==e.lastIndexOf("::"))return!1;if(e.split(":").length>8)return!1;var d=e.split("::"),u=!0,p=!1,f=void 0;try{for(var m,h=s()(d);!(u=(m=h.next()).done);u=!0){var v=m.value;if(v){var g=!0,_=!1,y=void 0;try{for(var w,C=s()(v.split(":"));!(g=(w=C.next()).done);g=!0){var k=w.value;if(!b(k))return!1}}catch(e){_=!0,y=e}finally{try{!g&&C.return&&C.return()}finally{if(_)throw y}}}}}catch(e){p=!0,f=e}finally{try{!u&&h.return&&h.return()}finally{if(p)throw f}}return!0},w=function(e){return e=e.trim(),/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])(\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])){3}$/.test(e)},C=function(e){return e.indexOf(":")>0?y(e):w},k=function(e){return/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/.test(e)};t.a={confirm:u,notify:p,get:f,post:m,urlParam:n,deepCopy:i,strTrim:h,arrayToOptions:v,objArrayToOptions:_,objToOptions:g,isValidIP:C,isValidIpv6:y,isValidIpv4:w,isValidDomain:k}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){function n(e){a(208)}var i=a(1)(a(124),a(252),n,null,null);e.exports=i.exports},function(e,t,a){function n(e){a(222)}var i=a(1)(a(125),a(266),n,"data-v-bc469716",null);e.exports=i.exports},function(e,t,a){function n(e){a(215)}var i=a(1)(a(128),a(259),n,"data-v-614902c4",null);e.exports=i.exports},function(e,t,a){function n(e){a(206)}var i=a(1)(a(129),a(250),n,"data-v-04d1261a",null);e.exports=i.exports},function(e,t,a){function n(e){a(224)}var i=a(1)(a(136),a(268),n,"data-v-d1c292b4",null);e.exports=i.exports},function(e,t,a){"use strict";var n=a(2),i=a(270),o=a(236),s=a.n(o),r=a(88),l=a.n(r),c=a(89),d=a.n(c),u=a(249),p=a.n(u),f=a(240),m=a.n(f),h=a(238),v=a.n(h),g=a(239),_=a.n(g),b=a(87),y=a.n(b),w=a(243),C=a.n(w),k=a(90),x=a.n(k),S=a(86),I=a.n(S);n.default.use(i.a),t.a=new i.a({routes:[{path:"/login",name:"login",component:y.a},{path:"/",name:"approot",component:I.a,children:[{path:"system",component:C.a,children:[{path:"user",component:x.a}]},{path:"preview",name:"preview",component:_.a},{path:"view",name:"view",component:p.a},{path:"record",name:"Record",component:m.a},{path:"conf",name:"Conf",component:s.a,children:[{path:"zone",component:d.a},{path:"hostgroup",component:l.a}]},{path:"dnslog",name:"DnsLog",component:v.a}]}]})},function(e,t,a){"use strict";var n=a(2),i=a(25);n.default.use(i.a),t.a=new i.a.Store({state:{menu_index:"/system",loading:!1,activeTab:"user",userName:""},mutations:{changeTab:function(e,t){e.activeTab=t,console.log(t)},changeMenuIndex:function(e,t){console.log(t),e.menu_index=t},changeUsername:function(e,t){e.userName=t}}})},,function(e,t){},function(e,t){},function(e,t){},function(e,t,a){function n(e){a(219)}var i=a(1)(a(123),a(263),n,null,null);e.exports=i.exports},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a(97),o=a.n(i),s=a(91),r=a(93),l=a.n(r),c=a(98),d=a(25),u=a(94),p=(a.n(u),a(95)),f=(a.n(p),a(96)),m=(a.n(f),a(92));n.default.use(l.a),n.default.use(c.a),n.default.use(d.a),n.default.config.productionTip=!1,new n.default({el:"#app",store:m.a,router:s.a,template:"<App/>",components:{App:o.a}})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(25),i=a(4),o=a(87),s=a.n(o),r=a(86),l=a.n(r);t.default={name:"app",mounted:function(){this.getUser()},components:{Login:s.a,Menu:l.a},computed:a.i(n.b)({userName:function(e){return e.userName}}),methods:{getUser:function(){var e=this;i.a.get(this,{url:"/web/auth/logged_in_user",succ:function(t){e.$store.commit("changeUsername",t.data)}})},logout:function(){this.$store.commit("changeUsername",""),i.a.post(this,{url:"/web/auth/logout",succ:function(e){console.log(e)}})}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={1:"/preview",2:"/record",3:"/view",4:"/conf",5:"/system",6:"/dnslog"},i={};for(var o in n)i[n[o]]=o;t.default={name:"dnsdbmenu",data:function(){return{activeIndex:"1"}},mounted:function(){"/"===this.$router.currentRoute.path?this.$router.push("/preview"):(this.activeIndex=i[this.$router.currentRoute.path],this.$router.push(n[this.activeIndex]))},methods:{handleSelect:function(e){this.activeIndex=e,this.$router.push(n[this.activeIndex])}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(34),i=a.n(n),o=a(25),s=a(4);t.default={name:"page",mounted:function(){this.$store.commit("changeUsername","")},data:function(){return{errMsg:"",form:{username:"",password:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:4,max:64,message:"长度在 4 到 64 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:9,message:"长度在 6 到 9 个字符",trigger:"blur"}]}}},methods:{onSubmit:function(e){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;s.a.post(t,{url:"/web/auth/login",data:{username:t.form.username,password:t.form.password},post_data_type:"json",succ:function(e){t.resetForm("form"),t.$store.commit("changeUsername",e.data),console.log(t.$store.state.userName),t.goBack()}})})},resetForm:function(e){this.$refs[e].resetFields()},goBack:function(){window.history.length>1?this.$router.go(-1):this.$router.push("/")}},computed:i()({},a.i(o.b)({loading:"loading"}))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(89),i=a.n(n),o=a(88),s=a.n(o),r=a(237),l=a.n(r);t.default={name:"Manager",components:{ZoneManager:i.a,HostManager:s.a,HeaderEdit:l.a},data:function(){return{activeName:"host"}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(4);t.default={name:"HeaderEdit",data:function(){return{zoneList:[],curZoneName:"",zoneHeaderContent:"",updateHeaderLoading:!1}},mounted:function(){this.fetchZoneList()},methods:{fetchZoneList:function(){var e=this;n.a.get(this,{url:"/web/config/list/zone_header",succ:function(t){e.zoneList=t.data}})},getZoneHeader:function(e){var t=this;n.a.get(this,{url:"/web/config/get/zone_header",data:{zone_name:e},succ:function(a){t.curZoneName=e,t.zoneHeaderContent=a.data.header}})},checkZoneHeader:function(){n.a.post(this,{url:"/web/config/check_zone_header",data:{zone_name:this.curZoneName,header_content:this.zoneHeaderContent},succStr:"语法检查通过！"})},updateZoneHeader:function(){var e=this;this.$confirm("是否更新"+this.curZoneName+"的头文件?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.post(e,{url:"/web/config/update/zone_header",data:{zone_name:e.curZoneName,header_content:e.zoneHeaderContent},succ:function(t){n.a.notify(e,"成功","更新头文件成功"),e.updateHeaderLoading=!0,e.getZoneHeader(e.curZoneName),e.updateHeaderLoading=!1}})}).catch(function(){e.$message({type:"info",message:"已取消更新头文件"})})}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(17),i=a.n(n),o=a(4),s={_count:1,get:function(){return+new Date+"_"+this._count++}};t.default={name:"HostManager",data:function(){return{hostGroupList:[],addHostGroupVisible:!1,addGroupForm:{name:""},groupRules:{name:[{validator:function(e,t,a){t=t.trim(),""===t?a(new Error("请输入主机组名称")):(t.indexOf("Master")>=0||t.indexOf("Slave")>=0?a():a(new Error("主机组名需要以Slave或Master结尾")),a())},trigger:"blur"}]},addHostArray:{sel:null,columns:[{field:"name",title:"主机名"},{field:"ip",title:"主机ip"}],data:[]},editHostGroupVisible:!1,editGroupTitle:"",editHostArray:{groupName:"",sel:null,columns:[{field:"host_name",title:"主机名"},{field:"host_ip",title:"主机ip"}],data:[]},curHostGroupName:"",namedConf:"",namedConfDialogVisible:!1,namedConfLoading:!1,hasNamedConf:!1}},mounted:function(){this.fetchHostGroupList()},methods:{fetchHostGroupList:function(){var e=this;this.$http.get("/web/config/list/host_group").then(function(t){e.hostGroupList=t.data.data}).catch(function(e){console.log(e)})},handleAddHost:function(){for(var e in this.addHostArray.data){var t=this.addHostArray.data[e];if(t.isSet&&!this.handleSaveHost(t,e))return}var a={name:"",ip:"",isSet:!0};this.addHostArray.data.push(a),this.addHostArray.sel=JSON.parse(i()(a))},handleSaveHost:function(e,t){var a=JSON.parse(i()(this.addHostArray.sel));for(var n in a){var o=a[n];if(("name"===n||"ip"===n)&&""===(o=o.trim()))return this.$message.warning("字段不能为空"),!1;e[n]=o}return this.readHostArray(),e.isSet=!1,!0},handleCancelChange:function(e,t){if(!this.addHostArray.sel.id)return void this.addHostArray.data.splice(t,1);e.isSet=!e.isSet},handleDeleteHost:function(e){this.addHostArray.data.splice(e,1)},handleModifyHost:function(e,t){for(var a in this.addHostArray.data){var n=this.addHostArray.data[a];if(n.isSet&&n.id!==e.id&&!this.handleSaveHost(n,a))return!1}this.addHostArray.sel=JSON.parse(i()(e)),e.isSet=!0},readHostArray:function(){this.addHostArray.data.map(function(e){return e.id=s.get(),e.isSet=!1,e})},clearHostGroupInfo:function(){this.addHostGroupVisible=!1,this.addHostArray.sel={},this.addHostArray.data=[],this.addGroupForm.name=""},clearModifyGroupInfo:function(){this.fetchHostGroupList(),this.editHostGroupVisible=!1,this.editHostArray.sel={},this.editHostArray.data=[],this.editHostArray.groupName=""},submitAddHostGroup:function(){var e=this;for(var t in this.addHostArray.data){var a=this.addHostArray.data[t];if(a.isSet&&!this.handleSaveHost(a,t))return!1}this.$refs.addGroupForm.validate(function(t){if(!t)return!1;var a={group_name:e.addGroupForm.name,hosts:[]},n=[],i=e.addHostArray.data;for(var s in i)n.push({host_name:i[s].name,host_ip:i[s].ip});a.hosts=n,o.a.post(e,{url:"/web/config/add/host_group",data:a,succ:function(t){e.$notify.success({title:"成功",message:"新加主机组成功",duration:1500}),e.fetchHostGroupList(),e.clearHostGroupInfo()}})})},handleDeleteGroup:function(e){var t=this;this.$confirm("确认删除主机组 "+e,"确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.post(t,{url:"/web/config/delete/host_group",data:{group_name:e},succ:function(e){o.a.notify(t,"成功","删除主机组成功"),t.fetchHostGroupList()}})}).catch(function(){})},handleEditGroup:function(e,t){this.editGroupTitle="编辑主机组: "+e,this.editHostGroupVisible=!0,this.editHostArray.data=t,this.editHostArray.groupName=e},handleAddHostForModify:function(){for(var e in this.editHostArray.data){if(this.editHostArray.data[e].isSet)return this.$message.warning("请先提交当前编辑项"),!1}var t={host_name:"",host_ip:"",isSet:!0};this.editHostArray.data.push(t),this.editHostArray.sel=JSON.parse(i()(t))},submitHost:function(e,t){var a=this,n=JSON.parse(i()(this.editHostArray.sel));for(var s in n){var r=n[s];if(("host_name"===s||"host_ip"===s)&&""===(r=r.trim()))return this.$message.warning("字段不能为空"),!1;e[s]=r}o.a.post(this,{url:"web/config/add/host",data:{group_name:this.editHostArray.groupName,host_ip:e.host_ip,host_name:e.host_name},succ:function(t){return a.$notify.success({title:"成功",message:"新加主机成功",duration:1500}),e.isSet=!1,!0}})},submitDeleteHost:function(e,t){var a=this;for(var n in this.editHostArray.data){if(this.editHostArray.data[n].isSet)return this.$message.warning("请先提交当前编辑项"),!1}this.$confirm("确认删除主机 "+e,"确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.post(a,{url:"web/config/delete/host",data:{host_name:e,group_name:a.editHostArray.groupName},succ:function(e){a.$notify.success({title:"成功",message:"删除主机成功",duration:1500}),a.editHostArray.data.splice(t,1)}})}).catch(function(){})},getNamedConfHeader:function(e){this.curHostGroupName=e,this.requestNamedConfHeader(e),this.namedConfDialogVisible=!0},requestNamedConfHeader:function(e){var t=this;o.a.get(this,{url:"/web/config/get/named_conf_header",data:{group_name:e},succ:function(e){console.log(e),t.namedConf=e.data}})},updateNamedConfHeader:function(){var e=this;this.$confirm("是否保存 "+this.curHostGroupName+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.namedConfLoading=!0,o.a.post(e,{url:"/web/config/update/named_conf_header",data:{name:e.curHostGroupName,conf_content:e.namedConf},succStr:"保存成功"}),e.namedConfLoading=!1,e.namedConfDialogVisible=!1,e.fetchHostGroupList()}).catch(function(){})},setGroupReloadStatus:function(e){var t=this,a=e.reload_status,n="是否";n+=a?"打开 reload?":"关闭 reload?",this.$confirm(n,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a=a?1:0,o.a.post(t,{url:"/web/config/update/group_reload_status",data:{reload_status:a,group_name:e.group_name},succStr:"设置Reload状态成功",fail:function(n){e.reload_status=!a,t.$confirm(n.message+"，请检查后重试","失败",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){}).catch(function(){})}})}).catch(function(){e.reload_status=!a,t.$message({type:"info",message:"已取消切换"})})}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(17),i=a.n(n),o=a(4);t.default={name:"ZoneManager",data:function(){return{options:[{value:0,label:"反解"},{value:2,label:"普通"}],hostGroupList:[],zoneConfList:[],zoneConfLoading:!1,editZoneDialogVisible:!1,editZoneName:"",editZoneConf:[],editZoneType:2,editGroupConf:"",addZoneDialogVisible:!1,addZoneConf:[],addZoneName:"",addGroupConf:"",addZoneType:2,addZoneHeader:!0}},mounted:function(){this.fetchHostGroupList(),this.fetchZoneConfList()},methods:{fetchHostGroupList:function(){var e=this;o.a.get(this,{url:"/web/config/get/has_named_group",succ:function(t){e.hostGroupList=t.data}})},fetchZoneConfList:function(){var e=this;o.a.get(this,{url:"/web/config/list/named_zone",succ:function(t){e.zoneConfList=t.data}})},openEditConfDialog:function(e){var t=this;o.a.get(this,{url:"/web/config/get/named_zone",data:{zone_name:e},succ:function(a){t.editZoneDialogVisible=!0,t.editZoneName=e,t.editZoneType=a.data.zone_type,t.editZoneConf=a.data.zone_conf,t.wrapEditConf(t.editZoneName,t.editZoneConf),t.editGroupConf=t.editZoneConf[0]}})},openAddConfDialog:function(){var e=this;this.$prompt("请输入Zone名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"Zone名",inputErrorMessage:"Zone名格式不正确"}).then(function(t){var a=t.value;e.addZoneType=2,a.toLowerCase().indexOf(".arpa")>=0&&(e.addZoneType=0),e.addZoneName=a,e.addZoneConf=[],e.buildZoneConf(e.addZoneName,e.addZoneConf),e.addGroupConf=e.addZoneConf[0],e.addZoneDialogVisible=!0,e.addZoneHeader=!0}).catch(function(){e.$message({type:"info",message:"取消新增"})})},getEditGroupConf:function(e){for(var t=0;t<this.editZoneConf.length;t++)this.editZoneConf[t].group===e&&(this.editGroupConf=this.editZoneConf[t])},getAddGroupConf:function(e){for(var t=0;t<this.addZoneConf.length;t++)this.addZoneConf[t].group===e&&(this.addGroupConf=this.addZoneConf[t])},editGetTemplate:function(e,t){t.indexOf("Master")>=0?this.editGroupConf.conf=this.getTemplateConf(e,"master"):this.editGroupConf.conf=this.getTemplateConf(e,"slave")},buildZoneConf:function(e,t){if(0===t.length)for(var a in this.hostGroupList){var n=this.hostGroupList[a].group_name;n.indexOf("Master")>=0?t.push({group:n,conf:this.getTemplateConf(e,"master")}):t.push({group:n,conf:this.getTemplateConf(e,"slave")}),t[t.length-1].use=!1}},wrapEditConf:function(e,t){for(var a in this.hostGroupList){var n=!1,i=this.hostGroupList[a].group_name;for(var o in t)t[o].group===i&&(n=!0,t[o].use=!0);n||(i.indexOf("Master")>=0?t.push({group:i,conf:this.getTemplateConf(e,"master")}):t.push({group:i,conf:this.getTemplateConf(e,"slave")}),t[t.length-1].use=!1)}},unWrapEditConf:function(e){var t={};for(var a in e)e[a].use&&(t[e[a].group]=e[a].conf);return"{}"===i()(t)?(o.a.notify(this,"错误","至少有一组生效主机","error"),!1):t},getFileNameFromZoneName:function(e){if(e.toLowerCase().indexOf(".in-addr.arpa")>0){var t=e.toLowerCase().replace(".in-addr.arpa","");return t=t.split(".").reverse().join(".")+".zone"}return e},getTemplateConf:function(e,t){var a=this.getFileNameFromZoneName(e);return"master"===t?'zone "'+e+'" {\n\ttype master;\n\tfile "'+a+'";\n};':'zone "'+e+'" {\n\ttype slave;\n\tfile "slave/'+a+'";\n\tmasters {\n\t\t ip_of_master;\n\t};\n};'},selectGroupConf:function(e){e.use=!e.use},checkConf:function(e){var t=this.unWrapEditConf(e);if(!t)return!1;o.a.post(this,{url:"web/config/check_named_zone",data:{zone:this.addZoneName,conf:t},succStr:"语法检查通过"})},submitEditConf:function(){var e=this,t=this.unWrapEditConf(this.editZoneConf);if(!t)return!1;this.$confirm("是否修改 "+this.editZoneName+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.post(e,{url:"/web/config/update/named_zone",data:{zone:e.editZoneName,zone_type:e.editZoneType,conf:t},succ:function(t){o.a.notify(e,"成功","修改成功"),e.editZoneDialogVisible=!1,e.zoneConfLoading=!0,e.fetchZoneConfList(),e.zoneConfLoading=!1}})}).catch(function(){e.$message({type:"info",message:"已取消修改"})})},submitAddConf:function(){var e=this,t=this.unWrapEditConf(this.addZoneConf);if(!t)return!1;this.$confirm("是否新增 "+this.addZoneName+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.post(e,{url:"/web/config/add/named_zone",data:{zone:e.addZoneName,zone_type:e.addZoneType,conf:t,add_header:e.addZoneHeader},succ:function(t){o.a.notify(e,"成功","修改成功"),e.addZoneDialogVisible=!1,e.zoneConfLoading=!0,e.fetchZoneConfList(),e.zoneConfLoading=!1}})}).catch(function(){e.$message({type:"info",message:"已取消新增"})})},deleteZoneConf:function(e){var t=this;this.$confirm("是否删除 "+e+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.post(t,{url:"/web/config/delete/named_zone",data:{zone:e},succ:function(e){o.a.notify(t,"成功","删除成功"),t.zoneConfLoading=!0,t.fetchZoneConfList(),t.zoneConfLoading=!1}})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(17),i=a.n(n),o=a(4),s="/web/preview/";t.default={name:"DnsLog",data:function(){return{dateRange:[],start:"",end:"",pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},dnsLog:[],page:1,pageSize:30,domain:"",rtx_id:"",type:"",total:0,typeObj:{},filedObj:{},typeOptions:[],logMap:{},updateLog:!1,intervalId:-1}},mounted:function(){var e=this;this.fetchOperationConstant(),this.fetchDnsLog(),this.intervalId=setInterval(function(){console.log(e.updateLog),e.updateLog&&e.fetchDnsLog()},2e3)},destroyed:function(){clearInterval(this.intervalId)},methods:{sortTypeOption:function(e,t){return e.label<t.label},fetchOperationConstant:function(){var e=this;o.a.get(this,{url:s+"list/operation_constant",succ:function(t){e.typeObj=t.data.type_dict,e.typeOptions=o.a.objToOptions(e.typeObj).sort(e.sortTypeOption),e.filedObj=t.data.filed_dict}})},initMap:function(){},clearCondition:function(){this.start="",this.end="",this.page=1,this.pageSize=30,this.domain="",this.type="",this.rtx_id="",this.dateRange=[],this.fetchDnsLog()},retryDeploy:function(e){var t=this;this.$confirm("是否重试该任务","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.post(t,{url:s+"retry_deploy_job",data:{deploy_id:e},succ:function(e){o.a.notify(t,"成功","重试成功","success"),t.fetchDnsLog()}})}).catch(function(){t.$message.info("取消重试部署任务")})},getFailDetail:function(e){var t=this;o.a.get(this,{url:s+"get/dns_log_detail",data:{id:e},succ:function(e){null!==e.data&&t.$alert(e.data,"错误详情",{confirmButtonText:"确定"})}})},fetchDnsLog:function(){var e=this,t={page:this.page,page_size:this.pageSize,start_time:this.start,end_time:this.end};""!==this.domain&&(t.domain=this.domain),""!==this.type&&(t.type=this.type),""!==this.rtx_id&&(t.rtx_id=this.rtx_id),o.a.get(this,{url:s+"list/operation_log",data:t,succ:function(t){e.formatLog(t.data.logs),e.dnsLog=t.data.logs,e.total=t.data.total}})},changeDateRange:function(e){this.start=e[0],this.end=e[1]},handleCurrentChange:function(e){this.page=e,this.fetchDnsLog()},arrayFileds:function(e){var t=[];if("{}"!==e){var a=JSON.parse(e);for(var n in a){var o=a[n];if(i()(o).startsWith("{")){var s=[];for(var r in o)r in this.filedObj&&(r=this.filedObj[r]),s.push(r+": "+o[r]);o=s.toString()}n in this.filedObj&&(n=this.filedObj[n]),t.push(n+": "+o)}}return t},generalFormat:function(e){e.op_before=this.arrayFileds(e.op_before),e.op_after=this.arrayFileds(e.op_after)},formatLog:function(e){this.updateLog=!1;for(var t in e){var a=e[t];"wait"!==a.op_result&&"start"!==a.op_result||(this.updateLog=!0),void 0!==this.logMap[a.op_type]?this.logMap[a.op_type](a):this.generalFormat(a)}},format:function(e){e.op_before=JSON.parse(e.op_before),e.op_after=JSON.parse(e.op_after);for(var t=[],a=[],n=0;n<e.op_before.length;n++){var i="",o=e.op_before[n];i+=o.isp_name+": ";var s=[];for(var r in o.state)"cdn"===r?s.push(o.state.cdn):s.push(r);s=s.sort(),i+=s.join(","),t.push(i)}for(var l=0;l<e.op_after.length;l++){var c="",d=e.op_after[l];c+=d.isp_name+": ";var u=[];for(var p in d.state)"cdn"===p?u.push(d.state.cdn):u.push(p);u=u.sort(),c+=u.join(","),a.push(c)}e.op_before=t,e.op_after=a}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(4);t.default={name:"DnsLog",data:function(){return{domainCount:0,migrateHistory:[],switchHistory:[],aclMigrateHistory:[],viewIspDict:{}}},mounted:function(){this.fetchDnsViewPriview(),this.fetchViewIspInfo()},methods:{fetchDnsViewPriview:function(){var e=this;n.a.get(this,{url:"/web/preview/get/previewinfo",succ:function(t){e.domainCount=t.data.domain_count,console.log(e.domainCount),e.domainCount.sort(function(e,t){return e.count-t.count}),e.migrateHistory=t.data.migrate,e.switchHistory=t.data.switch,e.aclMigrateHistory=t.data.acl_migrate}})},fetchViewIspInfo:function(){var e=this;n.a.get(this,{url:"/web/view/list/acl_isp_info",succ:function(t){e.viewIspDict=t.data}})}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(241),i=a.n(n),o=a(242),s=a.n(o);t.default={name:"Record",components:{RecordManager:i.a,SubnetManager:s.a},data:function(){return{activeName:"record"}},mounted:function(){},methods:{handleTabClick:function(e,t){"1"===e.$data.index||(this.domainInfo=[])}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(17),i=a.n(n),o=a(4);t.default={name:"AddRecord",data:function(){return{typeOptions:[{label:"域名",value:"domain"},{label:"解析",value:"record"}],recordTypeOptions:[{label:"A",value:"A"},{label:"AAAA",value:"AAAA"},{label:"CNAME",value:"CNAME"}],searchType:"domain",searchCondition:"",recordList:[],addRecordVisible:!1,regionOptions:[],zonesTTL:{},defaultTTL:"",addRecordName:"",addRecordType:"A",addRecordValue:"",addRecordTtl:0,addRecordSubnet:"",isAutoBind:!1,isCheckRecord:!0,editDialogVisible:!1,editName:"",originRecord:{},editRecord:{}}},mounted:function(){this.fetchRegionNames(),this.fetchZonesTTL()},methods:{fetchRegionNames:function(){var e=this;o.a.get(this,{url:"/web/subnet/list/region",succ:function(t){e.regionOptions=o.a.objArrayToOptions(t.data,"region_name","region_name")}})},fetchZonesTTL:function(){var e=this;o.a.get(this,{url:"/web/record/list/zone_ttl",succ:function(t){e.zonesTTL=t.data}})},searchGeneral:function(){var e=this,t={record:this.searchCondition};"domain"===this.searchType&&(t={domain_name:this.searchCondition}),o.a.get(this,{url:"/web/record/get/domain_records",data:t,succ:function(t){console.log(t.data),e.recordList=t.data}})},getDefaultTTL:function(){if(this.addRecordName=this.addRecordName.trim(),""===this.addRecordName)return!1;this.defaultTTL=0;var e=this.addRecordName.split(".");for(var t in e)if(0!==t){var a=e.slice(t).join(".");if(a in this.zonesTTL){this.defaultTTL=this.zonesTTL[a],console.log(a);break}}0===this.defaultTTL&&o.a.notify(this,"警告","没有适配的zone","warning")},addRecordSubmit:function(){var e=this;if(this.addRecordName=this.addRecordName.trim(),this.addRecordValue=this.addRecordValue.trim(),""===this.addRecordName)return o.a.notify(this,"错误","域名为空！","error"),!1;if(this.isAutoBind){if(""===this.addRecordSubnet)return o.a.notify(this,"错误","子网为空","error"),!1}else if(""===this.addRecordValue)return o.a.notify(this,"错误","域名记录为空！","error"),!1;this.$confirm("是否新增"+this.addRecordName+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.searchType="domain",e.searchCondition=e.addRecordName;var t="/web/record/manually_add_record",a={domain:e.addRecordName,record:e.addRecordValue,record_type:e.addRecordType,ttl:e.addRecordTtl,check_record:e.isCheckRecord};e.isAutoBind&&(t="web/record/auto_add_record",a={domain:e.addRecordName,region:e.addRecordSubnet}),o.a.post(e,{url:t,data:a,succ:function(t){o.a.notify(e,"成功","新增域名成功"),e.addRecordVisible=!1,e.searchGeneral()}})}).catch(function(){e.$message({type:"info",message:"已取消新增域名"})})},openEditDialog:function(e,t,a,n){this.editDialogVisible=!0,this.editName=e,this.originRecord={domain_name:e,record:t,record_type:a,ttl:n},this.editRecord={domain_name:e,record:t,record_type:a,ttl:n,check:!0}},modifyRecord:function(){var e=this,t={};return this.editRecord.record=this.editRecord.record.trim(),""===this.editRecord.record?(o.a.notify(this,"错误","\b记录不能为空","error"),!1):(this.editRecord.ttl=parseInt(this.editRecord.ttl),"number"!=typeof this.editRecord.ttl||this.editRecord.ttl<0?(o.a.notify(this,"错误","TTL必须是大于0的整数","error"),!1):this.editRecord.record===this.originRecord.record&&this.originRecord.record_type!==this.editRecord.record_type?(o.a.notify(this,"错误","记录类型错误","error"),!1):(this.editRecord.record!==this.originRecord.record&&(t.record_type=this.editRecord.record_type,t.record=this.editRecord.record,t.check_record=this.editRecord.check),this.editRecord.ttl!==this.originRecord.ttl&&(t.ttl=this.editRecord.ttl),""===i()(t)&&o.a.notify(this,"错误","请输入修改信息","error"),console.log(t),void this.$confirm("是否修改"+name+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.post(e,{url:"/web/record/modify_record",data:{domain_name:e.editName,origin_record:e.originRecord.record,update_dict:t},succ:function(t){o.a.notify(e,"成功","修改记录成功"),e.editDialogVisible=!1,e.searchGeneral()}})}).catch(function(){e.$message({type:"info",message:"已取消修改"})})))},deleteRecord:function(e,t,a){var n=this;this.$confirm("是否删除"+e+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.post(n,{url:"/web/record/delete",data:{domain_name:e,record:t,record_type:a},succ:function(e){o.a.notify(n,"成功","删除记录成功"),n.searchGeneral()}})}).catch(function(){n.$message({type:"info",message:"已取消删除"})})}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(4);t.default={name:"SubnetManager",data:function(){var e=function(e,t,a){t=t.trim();var i=t.split("/")[0];""===t?a(new Error("请输入网段")):t.indexOf("/")<0?a(new Error("请输入cidr格式网段: 192.168.0.0/24")):n.a.isValidIP(i)?a():a(new Error("网段格式错误"))},t=function(e,t,a){console.log(t),t=t.trim();var n=/^[a-zA-Z0-9_]+$/;""===t?a(new Error("请输入网段名称")):n.test(t)?t.length<=0||t.length>64?a(new Error("网段名称长度在[1-64]之间")):a():a(new Error("只能包含大小写字母、数字、下划线"))};return{subnetsList:[],loadingSubnet:!1,colos:[],coloOpions:[],searchOptions:[{label:"IP",value:"IP"},{label:"region",value:"region"}],searchType:"IP",searchCondition:"",renameSubnetVisible:!1,renameForm:{oldRegion:"",newRegion:""},addSubnetVisible:!1,subnetForm:{region:"",subnet:"",colo:"",comment:""},subnetRules:{region:[{required:!0,message:"请输入网段名称",trigger:"blur"},{validator:t,trigger:"blur"}],newRegion:[{required:!0,message:"请输入网段名称",trigger:"blur"},{validator:t,trigger:"blur"}],subnet:[{required:!0,message:"198.18.4.0/22",trigger:"blur"},{validator:e,trigger:"blur"}],colo:[{required:!0,message:"请选择机房",trigger:"blur"}]},SubnetDetailVisible:!1,ipList:[]}},mounted:function(){this.fetchColos(),this.fetchAllSubnet()},methods:{fetchColos:function(){var e=this;n.a.get(this,{url:"/web/subnet/get/subnet_colos",succ:function(t){e.colos=t.data,e.coloOpions=n.a.arrayToOptions(e.colos)}})},fetchAllSubnet:function(){var e=this;this.loadingSubnet=!0,n.a.get(this,{url:"/web/subnet/list/region",succ:function(t){e.subnetsList=t.data}}),this.loadingSubnet=!1},fetchSubnetIp:function(e){var t=this;n.a.get(this,{url:"/web/subnet/get/subnet_ip",data:{region:e},succ:function(e){t.ipList=e.data,t.SubnetDetailVisible=!0}})},searchGeneral:function(){var e=this,t="/web/subnet/get/region_by_ip",a={ip:this.searchCondition};if(""===this.searchCondition)return void this.fetchAllSubnet();"region"===this.searchType&&(t="/web/subnet/get/region_by_name",a={region:this.searchCondition}),n.a.get(this,{url:t,data:a,succ:function(t){e.subnetsList=t.data}})},clearSubnetForm:function(){this.addSubnetVisible=!1,this.subnetForm={region:"",subnet:"",colo:"",comment:""}},addSubnet:function(){var e=this;this.$refs.subnetForm.validate(function(t){if(!t)return!1;e.$confirm("是否新建子网"+e.subnetForm.region+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.post(e,{url:"/web/subnet/add/subnet",data:e.subnetForm,succ:function(t){n.a.notify(e,"成功","新增子网成功"),e.fetchAllSubnet(),e.clearSubnetForm()}})}).catch(function(){e.$message({type:"info",message:"已取消新建"})})})},deleteSubnet:function(e,t){var a=this;this.$confirm("是否删除"+e+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.post(a,{url:"/web/subnet/delete",data:{region:e,subnet:t},succ:function(e){n.a.notify(a,"成功","删除子网成功"),a.searchGeneral()}})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},openRenameDialog:function(e){this.renameSubnetVisible=!0,this.renameForm.oldRegion=e,this.renameForm.newRegion=""},renameSubnet:function(){var e=this;this.$refs.renameForm.validate(function(t){if(!t)return!1;e.$confirm("是否重命名子网"+e.renameForm.oldRegion+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.post(e,{url:"/web/subnet/rename_subnet",data:{old_region:e.renameForm.oldRegion,new_region:e.renameForm.newRegion},succ:function(t){n.a.notify(e,"成功","重命名子网成功"),e.renameSubnetVisible=!1,e.searchGeneral()}})}).catch(function(){e.$message({type:"info",message:"已取消重命名"})})})}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(90),i=a.n(n);t.default={name:"System",components:{UserManager:i.a},data:function(){return{activeName:"user"}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(4);t.default={name:"UserManager",data:function(){var e=this;return{roleObj:[],roleOption:[],searchOptions:[{label:"用户名",value:"byUser"},{label:"角色",value:"byRole"}],searchType:"byRole",searchRole:"",searchName:"",userList:[],page:1,pageSize:10,total:0,addUserForm:{username:"",email:"",roleId:"",password:"",confirmPassword:""},addUserRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:4,max:64,message:"长度在 4 到 64 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],roleId:[{required:!0,message:"请选择用户角色",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:9,message:"长度在 6 到 9 个字符",trigger:"blur"},{validator:function(t,a,n){""===a?n(new Error("请输入密码")):(""!==e.addUserForm.confirmPassword&&e.$refs.addUserForm.validateField("confirmPassword"),n())},trigger:"blur"}],confirmPassword:[{validator:function(t,a,n){""===a?n(new Error("请再次输入密码")):a!==e.addUserForm.password?n(new Error("两次输入密码不一致!")):n()},trigger:"blur"},{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:9,message:"长度在 6 到 9 个字符",trigger:"blur"}]},addUserVisible:!1}},mounted:function(){this.fetchRoleObj(),this.fetchUser()},methods:{fetchRoleObj:function(){var e=this;n.a.get(this,{url:"/web/user/roles",succ:function(t){e.roleObj=t.data,e.roleOption=n.a.objToOptions(e.roleObj)}})},fetchUserByUser:function(){var e=this;this.page=1,n.a.strTrim(this,"searchName"),n.a.get(this,{url:"/web/user/get",data:{username:this.searchName},succ:function(t){e.userList=t.data}})},fetchUserByRole:function(){var e=this,t={page:this.page,page_size:this.pageSize};""!==this.searchRole&&(t.role_id=this.searchRole),n.a.get(this,{url:"/web/user/list",data:t,succ:function(t){e.userList=t.data}})},fetchUser:function(){return"byUser"===this.searchType?this.fetchUserByUser():this.fetchUserByRole()},handleCurrentChange:function(e){this.page=e,this.fetchUser()},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.addUser()})},addUser:function(){var e=this;n.a.post(this,{url:"/web/user/add",data:{username:this.addUserForm.username,email:this.addUserForm.email,password:this.addUserForm.password,role_id:this.addUserForm.roleId},succ:function(t){e.addUserVisible=!1,n.a.notify(e,"成功","用户添加成功"),e.fetchUser()}})},postUserDelete:function(e){var t=this;n.a.post(this,{url:"/web/user/delete",data:e,succ:function(e){n.a.notify(t,"成功","删除用户成功"),t.fetchUser()}})},deleteUser:function(e){n.a.confirm(this,"是否删除用户"+e+"?",this.postUserDelete,{username:e})}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(4);t.default={name:"AclManager",data:function(){return{searchIP:"",subnetLoading:!1,aclRecordList:[],subnetMigrateVisible:!1,acMigrateSubnetId:-1,migrateSubnetFrom:"",migrate2acl:"",IspOptions:[],aclIspDict:{},addSubnetVisible:!1,addSubnetAcl:"",addSubnet:""}},mounted:function(){this.fetchMigrateSubnet(),this.fetchViewIspInfo()},methods:{fetchViewIspInfo:function(){var e=this;n.a.get(this,{url:"/web/view/list/acl_isp_info",succ:function(t){var a=t.data;console.log(a),e.aclIspDict=a,e.IspOptions=n.a.objToOptions(a)}})},searchAclByIP:function(){var e=this;if(this.searchIP=this.searchIP.trim(),""===this.searchIP)return this.fetchMigrateSubnet(),!1;this.subnetLoading=!0,this.aclRecordList=[],n.a.get(this,{url:"/web/view/list/acl_subnet_by_ip",data:{ip:this.searchIP},succ:function(t){e.aclRecordList=t.data,e.subnetLoading=!1}}),this.subnetLoading=!1},showMigrateDialog:function(e,t){this.subnetMigrateVisible=!0,this.acMigrateSubnetId=e,this.migrateSubnetFrom=t},postMigrateSubnet:function(){var e=this;n.a.post(this,{url:"/web/view/migrate_subnet_acl",data:{acl_subnet_id:this.acMigrateSubnetId,to_acl:this.migrate2acl},succ:function(t){n.a.notify(e,"成功","网段迁移成功"),e.searchAclByIP(),e.subnetMigrateVisible=!1}})},handleSubnetMigrate:function(){if(!this.migrate2acl)return this.$message.warning("请选择目标运营商"),!1;this.postMigrateSubnet()},fetchMigrateSubnet:function(){var e=this;this.subnetLoading=!0,n.a.get(this,{url:"/web/view/list/migrate_subnet",succ:function(t){e.aclRecordList=t.data,e.subnetLoading=!1}}),this.subnetLoading=!1},subnetIspRecover:function(e,t,a){var n=this;this.$confirm("是否恢复运营商","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.migrate2acl=t,n.acMigrateSubnetId=e,n.postMigrateSubnet()}).catch(function(){n.$notify.info({title:"取消",message:"已取消恢复",duration:1500})})},handleChoiceIsp:function(){console.log(this.migrate2acl)},handleAddSubnet:function(){var e=this;if(!this.checkSubnet())return!1;this.$confirm("是否添加网段"+this.addSubnet,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.post(e,{url:"/web/view/add/acl_subnet",data:{acl:e.addSubnetAcl,subnet:e.addSubnet},succ:function(t){e.searchIP=e.addSubnet.split("/")[0],e.addSubnetVisible=!1,e.searchAclByIP()}})}).catch(function(){e.$message.info("已取消新增")})},deleteSubnet:function(e){var t=this;n.a.post(this,{url:"/web/view/delete/acl_subnet",data:{subnet_id:e},succ:function(e){n.a.notify(t,"成功","删除网段成功"),t.searchAclByIP()}})},checkSubnet:function(){var e=this.addSubnet,t=e.split("/")[0];return""===e?(this.$message.warning("请输入网段"),!1):e.indexOf("/")<0?(this.$message.warning("请输入cidr格式网段: 192.168.0.0/24"),!1):!!n.a.isValidIP(t)||(this.$message.warning("网段格式错误"),!1)}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(18),i=a.n(n),o=a(144),s=a.n(o),r=a(17),l=a.n(r),c=a(26),d=a.n(c),u=a(4);t.default={name:"SearchDomain",data:function(){return{addDomainvisible:!1,addInputPlaceHolder:"",addDomainName:"",addDialogLoading:!1,addDomainInfo:[],addDialogTitle:"域名新增",checkAllServerRooms:!0,isSeverRoomsIndeterminate:!1,checkedServerRooms:[],serverRooms:[],selectCdn:!0,page:1,pageSize:15,domainName:"",domainListTotal:0,domainList:[],domainListPage:[],loadingDomainList:!1,checkAllIsps:!0,isIspsIndeterminate:!1,checkedIsps:[],isps:[],isMigrate:!1,stateDomainName:"",stateDomainInfo:[],stateDomainCdn:[],domainOriginInfo:[],loadingDomainInfo:!1,fullScreenLoading:!1}},mounted:function(){this.fetchIsp(),this.fetchServerRooms()},methods:{fetchIsp:function(){var e=this;u.a.get(this,{url:"/web/view/list/isp",succ:function(t){e.isps=t.data;for(var a=0;a<e.isps.length;a++)e.checkedIsps.push(e.isps[a].name_in_english)}})},fetchServerRooms:function(){var e=this;u.a.get(this,{url:"/web/view/list/server_room",succ:function(t){e.serverRooms=t.data,e.checkedServerRooms=e.serverRooms}})},deleteDomain:function(){var e=this,t=this.stateDomainName;this.$confirm("是否删除该域名: "+t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.fullScreenLoading=!0,u.a.post(e,{url:"/web/view/delete/view_domain",data:{domain_name:t},succ:function(t){u.a.notify(e,"成功","删除域名成功"),e.viewDomainList()}}),e.fullScreenLoading=!1}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleAddDomain:function(){this.addDialogTitle="域名新增",this.addDomainvisible=!0,this.domainName="",this.addDomainInfo=[];for(var e=0;e<this.serverRooms.length;e++){var t={name:this.serverRooms[e],inputValue:"",showInput:!1,conf:[]};this.addDomainInfo.push(t)}var a={name:"CDN",inputValue:"",showInput:!1,conf:[]};this.addDomainInfo.push(a)},handelEditDomain:function(){var e=this;this.loadingDomainInfo=!0,u.a.get(this,{url:"/web/view/get/view_domain_info",data:{domain_name:this.stateDomainName},succ:function(t){var a=t.data.rooms,n=t.data.cnames;e.addDomainInfo=[],e.addDialogTitle="域名配置修改",e.addDomainName=e.stateDomainName;var i=!0,o=!1,s=void 0;try{for(var r,l=d()(e.serverRooms);!(i=(r=l.next()).done);i=!0){var c=r.value,u={name:c,inputValue:"",showInput:!1,conf:[]};c in a&&(u.conf=a[c].ips),e.addDomainInfo.push(u)}}catch(e){o=!0,s=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw s}}var p={name:"CDN",inputValue:"",showInput:!1,conf:n.cdn};e.addDomainInfo.push(p),e.addDomainvisible=!0}}),this.loadingDomainInfo=!1},handleInputConfirm:function(e){var t=this.addDomainInfo[e].inputValue.trim();if("CDN"===this.addDomainInfo[e].name)if(t=t.split(":"),2===t.length){var a=t[0].trim(),n=t[1].trim();if(""===n||""===a)return this.$message.warning("参数不能为空"),!1;if(!u.a.isValidDomain(n))return this.$message.warning("CDN格式错误"),!1;this.addDomainInfo[e].conf.push({name:t[0].trim(),cname:t[1].trim()})}else this.$message.warning("请按照 name:cname的格式输入");else{if(t&&!u.a.isValidIP(t))return this.$message.warning("输入ip格式不正确"),!1;t&&this.addDomainInfo[e].conf.push(t)}this.addDomainInfo[e].showInput=!1,this.addDomainInfo[e].inputValue=""},handleShowInput:function(e){var t=this;this.addDomainInfo[e].showInput=!0;var a=this.addDomainInfo[e].name;this.$nextTick(function(e){t.$refs.saveTagInput.$refs.input.focus()}),this.addInputPlaceHolder="CDN"===a?"输入CDN域名":"输入ip"},handleCancelAdd:function(){this.addDialogTitle="",this.addDomainvisible=!1,this.domainName="",this.addDomainInfo=[],this.viewDomainList()},handleDeleteConf:function(e,t){var a=this.addDomainInfo[e].conf;a.splice(a.indexOf(t),1)},addDomainSubmit:function(){var e=this;if(""===this.addDomainName)return this.$message.warning("域名不能为空"),!1;for(var t={domain_name:this.addDomainName},a={},n={},i=0;i<this.addDomainInfo.length;i++){var o=this.addDomainInfo[i];if("CDN"!==o.name&&o.conf.length>0)a[o.name]=o.conf;else if("CDN"===o.name&&o.conf.length>0){var s=!0,r=!1,c=void 0;try{for(var p,f=d()(o.conf);!(s=(p=f.next()).done);s=!0){var m=p.value;n[m.name]=m.cname}}catch(e){r=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(r)throw c}}t.cnames=n}}if("{}"===l()(a)&&"{}"===l()(n))return this.$message.warning("请输入机房或CDN配置"),!1;"{}"!==l()(a)&&(t.rooms=a);var h="是否新增域名",v="/web/view/add/view_domain";"域名新增"!==this.addDialogTitle&&(h="是否提交修改",v="/web/view/update/view_domain"),this.$confirm(h,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.addDialogLoading=!0,u.a.post(e,{url:v,data:t,succ:function(t){u.a.notify(e,"成功","提交成功"),e.addDomainvisible=!1,e.viewDomain(e.addDomainName)}}),e.addDialogLoading=!1}).catch(function(){e.$message({type:"info",message:"已取消新增域名"})})},viewDomainList:function(){var e=this;this.stateDomainName="",this.loadingDomainList=!0,u.a.post(this,{url:"/web/view/list/view_domain",data:{server_rooms:this.checkedServerRooms,isps:this.checkedIsps,domain_name:this.domainName,select_cdn:this.selectCdn},succ:function(t){e.page=1,e.domainList=t.data,e.domainListTotal=e.domainList.length,e.domainListPage=e.domainList.slice((e.page-1)*e.pageSize,e.pageSize),e.loadingDomainList=!1,0===e.domainListTotal?e.$message.warning("无相关域名信息,请检查输入"):e.viewDomain(e.domainList[0].domain)}}),this.loadingDomainList=!1},viewDomain:function(e){var t=this;console.log(e),this.loadingDomainInfo=!0,u.a.get(this,{url:"/web/view/get/view_domain_info",data:{domain_name:e},succ:function(e){t.isMigrate=e.data.is_migrate,t.stateDomainInfo=[];var a=e.data.rooms;for(var n in a){var i=a[n],o={info:{name:n,is_enabled:i.is_enabled}};for(var s in i.isps)o[s]={is_enabled:i.isps[s],ips:i.ips};t.stateDomainInfo.push(o)}t.stateDomainInfo.sort(t.sortDomainInfo);var r=e.data.cnames;t.stateDomainCdn=r.cdn,t.stateDomainCdn.push({name:"不使用cdn",cname:"不使用cdn"});var l={info:{name:"cdn"}},c=r.isps;for(var d in c)l[d]=c[d];t.stateDomainInfo.push(l),t.stateDomainName=e.data.domain_name,t.domainOriginInfo=t.deepCopy(t.stateDomainInfo),t.loadingDomainInfo=!1}}),this.loadingDomainInfo=!1},switchAll:function(e,t){for(var a in this.stateDomainInfo[e])"info"!==a&&(this.stateDomainInfo[e][a].is_enabled=t,this.switchCn(a,t))},switchCn:function(e,t){if(t)for(var a=0;a<this.stateDomainInfo.length;a++){var n=this.stateDomainInfo[a];"cdn"===n.info.name&&(n[e].name="不使用cdn",n[e].cname="不使用cdn")}},switchCdn:function(e,t){if("不使用cdn"!==t){var a=!0,n=!1,i=void 0;try{for(var o,s=d()(this.stateDomainInfo);!(a=(o=s.next()).done);a=!0){var r=o.value;if("cdn"===r.info.name){var l=!0,c=!1,u=void 0;try{for(var p,f=d()(this.stateDomainCdn);!(l=(p=f.next()).done);l=!0){var m=p.value;m.name===r[e].name&&(r[e].cname=m.cname)}}catch(e){c=!0,u=e}finally{try{!l&&f.return&&f.return()}finally{if(c)throw u}}}else r[e].is_enabled=!1}}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}}},getChangeIsp:function(){var e=new s.a,t=!0,a=!1,n=void 0;try{for(var i,o=d()(this.isps);!(t=(i=o.next()).done);t=!0)for(var r=i.value,l=r.name_in_english,c=0;c<this.stateDomainInfo.length;c++){var u=this.stateDomainInfo[c],p=this.domainOriginInfo[c];"cdn"!==u.info.name&&u[l].is_enabled!==p[l].is_enabled&&e.add(l),"cdn"===u.info.name&&u[l].name!==p[l].name&&"不使用cdn"!==u[l].name&&(e.add(l+":cdn:"+u[l].cname),e.delete(l))}}catch(e){a=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(a)throw n}}return e},submitModify:function(){var e=this,t=this.getChangeIsp();if(0===t.size)return this.$message.warning("无修改,请勿提交."),!1;var a={domain_name:this.stateDomainName};if(0!==t.size){var n={},i=!0,o=!1,s=void 0;try{for(var r,l=d()(t);!(i=(r=l.next()).done);i=!0){var c=r.value;if(c.indexOf(":")>0){var p=c.split(":");n[p[0]]={cdn:p[2]}}else{for(var f=[],m=0;m<this.stateDomainInfo.length;m++){var h=this.stateDomainInfo[m];"cdn"!==h.info.name&&h[c].is_enabled&&f.push(h.info.name)}n[c]={rooms:f}}}}catch(e){o=!0,s=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw s}}a.isps=n,console.log(n)}this.$confirm("是否提交修改","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.fullScreenLoading=!0,u.a.post(e,{url:"/web/view/update/view_domain_state",data:a,succ:function(t){u.a.notify(e,"修改成功","提交修改成功"),e.fullScreenLoading=!1,e.viewDomain(e.stateDomainName)}}),e.fullScreenLoading=!1}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},handleCheckAllServerRoomChange:function(e){this.checkedServerRooms=e?this.serverRooms:[],this.isSeverRoomsIndeterminate=!1,this.selectCdn=e},handleCheckedRoomsChange:function(e){var t=e.length;this.checkAllServerRooms=t===this.serverRooms.length,this.isSeverRoomsIndeterminate=t>0&&t<this.serverRooms.length},handleCheckAllIspsChange:function(e){if(this.checkedIsps=[],e)for(var t=0;t<this.isps.length;t++)this.checkedIsps.push(this.isps[t].name_in_english);this.isIspsIndeterminate=!1},handleCheckedIspsChange:function(e){var t=e.length;this.checkAllIsps=t===this.isps.length,this.isIspsIndeterminate=t>0&&t<this.isps.length},handleCurrentChange:function(e){this.page=e,this.domainListPage=this.domainList.slice((this.page-1)*this.pageSize,e*this.pageSize)},deepCopy:function(e){var t={};for(var a in e)t[a]="object"===i()(e[a])?this.deepCopy(e[a]):e[a];return t},tagKey:function(e,t){return"CDN"===e?t.name:t},sortDomainInfo:function(e,t){return e.info.name>t.info.name}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={name:"IpManager",data:function(){return{ipActiveName:"operation",ipSearch:"",searchIpLoading:!1,ipStateList:[],canOff:!1,aqbVisible:!1,ipVisible:!1,switchTo:"",noAqbList:[],switchHistory:[],detailVisible:!1,detailPage:1,detailPageSize:18,detailTotal:0,switchDetails:[],switchId:0,intervalId:-1}},mounted:function(){var e=this;this.intervalId=setInterval(function(){"record"===e.ipActiveName&&e.fetchSwitchHistory()},2e3)},destroyed:function(){clearInterval(this.intervalId)},methods:{handleIpTabClick:function(e,t){"1"===e.$data.index&&this.fetchSwitchHistory()},searchIp:function(){var e=this;if(""===this.ipSearch)return this.$notify.error({title:"搜索IP失败",message:"IP不能为空",duration:1500}),!1;this.searchIpLoading=!0,this.$http.post("ui/list_ip_state",{ip:this.ipSearch}).then(function(t){e.ipStateList=t.data.data,e.canOff=!1;for(var a in e.ipStateList)0!==e.ipStateList[a].active.length&&(e.canOff=!0);e.searchIpLoading=!1}).catch(function(t){e.searchIpLoading=!1,console.log(t)})},switchIpToAqb:function(){var e=this;this.$confirm("是否将所有激活该ip的域名切换到高防","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post("ui/switch_ip_to_aqb",{ip:e.ipSearch}).then(function(t){"no_domain"===t.data.data?e.$notify.error({title:"错误",message:"没有可切换域名!",duration:1500}):"ip_switched"===t.data.data?e.$notify.error({title:"错误",message:"IP已经被切换!",duration:1500}):(e.noAqbList=t.data.data,e.aqbVisible=!0)}).catch(function(t){console.log(t),e.$notify.error({title:"错误",message:"切换错误",duration:1500})})}).catch(function(){e.$notify.info({title:"取消",message:"已取消切换",duration:1500})})},fetchSwitchHistory:function(){var e=this;this.$http.get("/ui/list_switch_history").then(function(t){e.switchHistory=t.data.data}).catch(function(e){console.log(e)})},switchIpFromAqb:function(e){var t=this;this.$confirm("是否取消该ip的高防配置","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post("ui/switch_ip_from_aqb",{switch_id:e}).then(function(e){t.searchIp(),t.$notify.success({title:"成功",message:"恢复成功",duration:1500})}).catch(function(e){console.log(e),t.$notify.error({title:"错误",message:"恢复错误",duration:1500})})}).catch(function(){t.$notify.info({title:"取消",message:"已取消恢复",duration:1500})})},replaceIp:function(){""===this.ipSearch?this.$notify.error({title:"错误",message:"替换ip为空",duration:1500}):this.ipVisible=!0},cancelReplaceIp:function(e){var t=this;this.$confirm("是否取消该ip的替换","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post("ui/cancel_replace_ip",{switch_id:e}).then(function(e){"ok"===e.data.data?(t.searchIp(),t.$notify.success({title:"成功",message:"恢复成功",duration:1500})):t.$notify.error({title:"错误",message:"恢复错误",duration:1500})}).catch(function(e){console.log(e),t.$notify.error({title:"错误",message:"恢复错误",duration:1500})})}).catch(function(){t.$notify.info({title:"取消",message:"已取消恢复",duration:1500})})},viewSwitchDetail:function(e){var t=this;this.switchId=e,this.$http.post("/ui/view_switch_detail",{switch_id:e,page:this.detailPage,page_size:this.detailPageSize}).then(function(e){t.switchDetails=e.data.data,t.detailTotal=e.data.total,t.detailVisible=!0}).catch(function(e){console.log(e),t.$notify.error({title:"获取记录失败",message:"未知错误!",duration:1500})})},handleDetailChange:function(e){this.detailPage=e,this.viewSwitchDetail(this.switchId)},handleCloseIpDialog:function(){var e=this;this.$http.post("/ui/replace_ip",{switch_ip:this.ipSearch,switch_to:this.switchTo}).then(function(t){var a=t.data.data;"ok"===a?e.$notify.success({title:"成功",message:"替换IP成功",duration:1500}):"ip_switched"===a?e.$notify.error({title:"错误",message:"IP已经替换",duration:1500}):e.$notify.error({title:"错误",message:"IP替换失败",duration:1500}),e.ipActiveName="record",e.ipVisible=!1}).catch(function(t){e.$notify.error({title:"错误",message:"替换IP失败",duration:1500}),console.log(t),e.ipVisible=!1})},handleCloseAqbDialog:function(){this.aqbVisible=!1,this.searchIp()}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(26),i=a.n(n),o=a(17),s=a.n(o),r=a(4);t.default={name:"IspManager",data:function(){return{isps:[],ispEname:"",ispCname:"",ispAname:"",editIspArray:{sel:null,editType:"add",checkFileds:["name_in_english","name_in_chinese","abbreviation"],addFileds:["name_in_english","name_in_chinese","abbreviation","acl_name","acl_file"],columns:[{field:"name_in_english",title:"英文名"},{field:"name_in_chinese",title:"中文别名"},{field:"abbreviation",title:"英文简写"},{field:"acl_name",title:"ACL名称"},{field:"acl_file",title:"ACL文件"}],data:[]}}},mounted:function(){this.fetchIsp()},methods:{fetchIsp:function(){var e=this;r.a.get(this,{url:"/web/view/list/isp",succ:function(t){e.editIspArray.data=t.data,e.isps=t.data}})},checkSubmit:function(){for(var e in this.editIspArray.data){if(this.editIspArray.data[e].isSet)return this.$message.warning("请先提交当前编辑项"),!1}return!0},handleAddIsp:function(){if(!this.checkSubmit())return!1;var e={name_in_english:"",abbreviation:"",name_in_chinese:"",acl_name:"",acl_file:"",isSet:!0};this.editIspArray.data.push(e),this.editIspArray.sel=JSON.parse(s()(e)),this.editIspArray.editType="add"},handleCancelIsp:function(e,t){"add"===this.editIspArray.editType?this.editIspArray.data.splice(t,1):(this.fetchIsp(),this.editIspArray.sel={})},handleEditIsp:function(e,t){if(!this.checkSubmit())return!1;this.editIspArray.editType="update",e.isSet=!0,this.editIspArray.sel=JSON.parse(s()(e))},addIsp:function(e){var t=this;this.$confirm("是否添加运营商","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.a.post(t,{url:"/web/view/add/isp",data:e,succ:function(e){r.a.notify(t,"成功","添加运营商成功","success"),t.editIspArray.sel={},t.fetchIsp()}})}).catch(function(){t.$notify.info({title:"取消",message:"取消添加运营商",duration:1500})})},updateIsp:function(e,t){var a=this,n={},o=!0,s=!1,l=void 0;try{for(var c,d=i()(this.editIspArray.addFileds);!(o=(c=d.next()).done);o=!0){var u=c.value;"name_in_english"!==u&&e[u]!==t[u]&&(n[u]=t[u])}}catch(e){s=!0,l=e}finally{try{!o&&d.return&&d.return()}finally{if(s)throw l}}this.$confirm("是否修改运营商信息","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.a.post(a,{url:"/web/view/update/isp",data:{name_in_english:t.name_in_english,update_data:n},succ:function(t){r.a.notify(a,"成功","修改运营商成功","success"),e.isSet=!1,a.editIspArray.sel={},a.fetchIsp()}})}).catch(function(){a.$notify.info({title:"取消",message:"取消添加运营商",duration:1500})})},submitIsp:function(e,t){var a=JSON.parse(s()(this.editIspArray.sel)),n=!0,o=!1,r=void 0;try{for(var l,c=i()(this.editIspArray.addFileds);!(n=(l=c.next()).done);n=!0){var d=l.value;a[d]=a[d].trim()}}catch(e){o=!0,r=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw r}}var u=!0,p=!1,f=void 0;try{for(var m,h=i()(this.editIspArray.checkFileds);!(u=(m=h.next()).done);u=!0){if(""===a[m.value])return this.$message.warning("字段不能为空"),!1}}catch(e){p=!0,f=e}finally{try{!u&&h.return&&h.return()}finally{if(p)throw f}}"add"===this.editIspArray.editType?this.addIsp(a):this.updateIsp(e,a)},submitDeleteIsp:function(e,t){var a=this;for(var n in this.editIspArray.data){if(this.editIspArray.data[n].isSet)return this.$message.warning("请先提交当前编辑项"),!1}this.$confirm("确认删除主机 "+e,"确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.a.post(a,{url:"web/view/delete/isp",data:{name_in_english:e},succ:function(e){r.a.notify(a,"成功","删除运营商成功"),a.fetchIsp()}})}).catch(function(){})}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(26),i=a.n(n),o=a(4),s="/web/view/";t.default={name:"Migrate",data:function(){return{showTable:"",ColoOptions:[],IspOptions:[],srcRoomsChecked:[],ispsChecked:[],dstRoomsChecked:[],allIsps:[],ispStatus:[],migrateDomainList:[],spanObj:{},migrateListLoading:!1,migrateProcessDialogVisible:!1,migrateHistoryInfo:[],migrateDone:!1,migtateOperation:"",ispTransDict:{},migrateHistory:[],detailDialogVisible:!1,page:1,pageSize:18,total:0,detailDomain:"",migrateId:0,migrateDetails:[],migrateRules:"",autoRecover:!1,intervalId:-1,getIspStatusInterval:-1,getMigrateInfoInterval:-1,freshHistory:!1}},mounted:function(){var e=this;this.fetchServerRooms(),this.fetchIsp(),this.fetchMigrateHistory(),this.intervalId=setInterval(function(){"history"===e.showTable&&e.freshHistory&&e.fetchMigrateHistory()},2e3),this.getMigrateInfoInterval=setInterval(function(){e.migrateHistoryInfo!==[]&&e.migrateProcessDialogVisible&&"done"!==e.migrateHistoryInfo[0].state&&e.getMigrateInfo()},2e3)},destroyed:function(){clearInterval(this.intervalId),clearInterval(this.getMigrateInfoInterval)},methods:{fetchIsp:function(){var e=this;o.a.get(this,{url:s+"list/isp",succ:function(t){e.IspOptions=[{label:"全选",value:"all"}],e.allIsps=[],e.ispTransDict={};var a=t.data;for(var n in a){var i=a[n],o={};o.label=i.name_in_chinese,o.value=i.name_in_english,e.IspOptions.push(o),e.ispTransDict[i.name_in_english]=i.name_in_chinese,e.allIsps.push(i.name_in_english)}e.IspOptions.push({label:"清除",value:"clear"})}})},fetchServerRooms:function(){var e=this;o.a.get(this,{url:s+"list/server_room",succ:function(t){e.ColoOptions=o.a.arrayToOptions(t.data)}})},handleMigrateIspChange:function(){-1!==this.ispsChecked.indexOf("all")?this.ispsChecked=this.allIsps:-1!==this.ispsChecked.indexOf("clear")&&(this.ispsChecked=[])},clearMigrateParams:function(){this.srcRoomsChecked=[],this.ispsChecked=[]},listMigrateDomain:function(){var e=this;if(0===this.srcRoomsChecked.length||0===this.ispsChecked.length||0===this.dstRoomsChecked.length)return void this.$message.warning("参数不能为空");this.migrateListLoading=!0,this.showTable="domains",o.a.post(this,{url:s+"list_migrate_domain",data:{src_rooms:this.srcRoomsChecked,dst_rooms:this.dstRoomsChecked,isps:this.ispsChecked},succ:function(t){e.migrateDomainList=t.data,e.migrateListLoading=!1}}),this.migrateListLoading=!1},arraySpanMethod:function(e){var t=(e.row,e.column,e.rowIndex);if(0===e.columnIndex)return t in this.spanObj?this.spanObj[t]:[0,0]},fetchMigrateHistory:function(){var e=this;this.showTable="history",this.freshHistory=!1,o.a.get(this,{url:s+"list/migrate_history",succ:function(t){e.migrateHistoryInfo=t.data;var a=!0,n=!1,o=void 0;try{for(var s,r=i()(e.migrateHistoryInfo);!(a=(s=r.next()).done);a=!0){if("migrating"===s.value.state){e.freshHistory=!0;break}}}catch(e){n=!0,o=e}finally{try{!a&&r.return&&r.return()}finally{if(n)throw o}}}})},migrateRooms:function(){var e=this;if(0===this.srcRoomsChecked.length||0===this.ispsChecked.length||0===this.dstRoomsChecked.length)return void this.$message.warning("参数不能为空");this.$confirm("是否开始迁移","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.post(e,{url:s+"migrate_rooms",data:{src_rooms:e.srcRoomsChecked,dst_rooms:e.dstRoomsChecked,isps:e.ispsChecked},succ:function(t){o.a.notify(e,"成功","机房迁移成功"),e.fetchMigrateHistory()}})}).catch(function(){e.$message.info("取消迁移")})},getMigrateInfo:function(){var e=this;o.a.get(this,{url:s+"get/migrate_info",data:{history_id:this.migrateHistoryInfo[0].id},succ:function(t){e.migrateHistoryInfo=t.data}})},onekeyRecoverRooms:function(){var e=this;this.$confirm("是否一键恢复所有已迁移机房","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.a.post(e,{url:s+"onekey_recover_rooms",succStr:"一键恢复成功"})}).catch(function(){e.$message.info("取消一键恢复")}),this.freshHistory=!0},viewPagedDetail:function(e){var t=this;this.migrateId=e,this.detailDomain="",o.a.get(this,{url:s+"get/view_migrate_detail",data:{migrate_id:e,page:this.page,page_size:this.pageSize,domain:this.detailDomain},succ:function(e){t.migrateDetails=e.data.detail,t.total=e.data.total,t.detailDialogVisible=!0,t.migrateRules=e.data.migrate_rules}})},getStatus:function(e,t,a){return"error"===a?"exception":e===t?"success":""},handleCurrentChange:function(e){this.page=e,this.viewPagedDetail()}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(245),i=a.n(n),o=a(246),s=a.n(o),r=a(247),l=a.n(r),c=a(244),d=a.n(c),u=a(248),p=a.n(u);t.default={name:"ViewIndex",components:{DomainManager:i.a,IpManager:s.a,IspManager:l.a,AclManager:d.a,Migrate:p.a},data:function(){return{activeTab:"domain"}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,,,,,,,function(e,t,a){function n(e){a(214)}var i=a(1)(a(126),a(258),n,"data-v-5797dd8a",null);e.exports=i.exports},function(e,t,a){function n(e){a(209)}var i=a(1)(a(127),a(253),n,"data-v-17d7fb8e",null);e.exports=i.exports},function(e,t,a){function n(e){a(207)}var i=a(1)(a(130),a(251),n,"data-v-0cf025ea",null);e.exports=i.exports},function(e,t,a){function n(e){a(216)}var i=a(1)(a(131),a(260),n,"data-v-7306824d",null);e.exports=i.exports},function(e,t,a){function n(e){a(217)}var i=a(1)(a(132),a(261),n,"data-v-7a971bdb",null);e.exports=i.exports},function(e,t,a){function n(e){a(221)}var i=a(1)(a(133),a(265),n,"data-v-b2f3fdfc",null);e.exports=i.exports},function(e,t,a){function n(e){a(211)}var i=a(1)(a(134),a(255),n,"data-v-33078a76",null);e.exports=i.exports},function(e,t,a){function n(e){a(225)}var i=a(1)(a(135),a(269),n,"data-v-d66573ca",null);e.exports=i.exports},function(e,t,a){function n(e){a(223)}var i=a(1)(a(137),a(267),n,"data-v-be163d0e",null);e.exports=i.exports},function(e,t,a){function n(e){a(212)}var i=a(1)(a(138),a(256),n,"data-v-48027f03",null);e.exports=i.exports},function(e,t,a){function n(e){a(210)}var i=a(1)(a(139),a(254),n,"data-v-24e8dbc0",null);e.exports=i.exports},function(e,t,a){function n(e){a(220)}var i=a(1)(a(140),a(264),n,"data-v-924ba806",null);e.exports=i.exports},function(e,t,a){function n(e){a(213)}var i=a(1)(a(141),a(257),n,"data-v-4d1846e5",null);e.exports=i.exports},function(e,t,a){function n(e){a(218)}var i=a(1)(a(142),a(262),n,"data-v-7f026c4a",null);e.exports=i.exports},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{type:"info"},on:{click:e.openAddConfDialog}},[e._v("新增Zone")]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.zoneConfLoading,expression:"zoneConfLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"small-table",attrs:{border:"",data:e.zoneConfList}},[a("el-table-column",{attrs:{prop:"zone_name",label:"Zone",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"zone_group",label:"生效主机组",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.zone_group,function(t){return a("span",[e._v("\n                "+e._s(t)+"\n              ")])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operation",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){e.openEditConfDialog(t.row.zone_name)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){e.deleteZoneConf(t.row.zone_name)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",[e.editZoneDialogVisible?a("el-dialog",{attrs:{title:e.editZoneName,visible:e.editZoneDialogVisible},on:{"update:visible":function(t){e.editZoneDialogVisible=t}}},[a("el-row",{attrs:{gutter:0,type:"flex"}},[a("el-col",{attrs:{span:5}},[a("span",{staticClass:"small-title"},[e._v("主机组：")]),e._v(" "),e._l(e.editZoneConf,function(t){return a("div",[a("el-checkbox",{attrs:{checked:t.use},on:{change:function(a){e.selectGroupConf(t)}}}),e._v(" "),a("span",{staticClass:"small-list-item",on:{click:function(a){e.getEditGroupConf(t.group)}}},[e._v(e._s(t.group))])],1)})],2),e._v(" "),a("el-col",{attrs:{span:19}},[a("el-row",{staticStyle:{"margin-bottom":"5px"},attrs:{gutter:0,type:"flex"}},[a("el-col",{attrs:{span:20}},[a("label",{staticClass:"small-title"},[e._v("编辑主机组："+e._s(e.editGroupConf.group))]),e._v(" "),a("label",{staticClass:"zone-type-label"},[e._v("Zone类型")]),e._v(" "),a("el-select",{staticClass:"zone-type-select",attrs:{size:"small",placeholder:"Zone类型"},model:{value:e.editZoneType,callback:function(t){e.editZoneType=t},expression:"editZoneType"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[a("el-button",{staticClass:"button",attrs:{size:"small"},on:{click:function(t){e.editGetTemplate(e.editZoneName,e.editGroupConf.group)}}},[e._v("填入模板")])],1)],1),e._v(" "),e.editGroupConf?a("el-input",{attrs:{autosize:{minRows:10},type:"textarea",spellcheck:"false",placeholder:"zone conf"},model:{value:e.editGroupConf.conf,callback:function(t){e.$set(e.editGroupConf,"conf",t)},expression:"editGroupConf.conf"}}):e._e()],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.openEditConfDialog(e.editZoneName)}}},[e._v("重 载")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:function(t){e.checkConf(e.editZoneConf)}}},[e._v("检 查")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitEditConf}},[e._v("保 存")])],1)],1):e._e(),e._v(" "),e.addZoneDialogVisible?a("el-dialog",{attrs:{title:"新增Zone",width:"50",visible:e.addZoneDialogVisible},on:{"update:visible":function(t){e.addZoneDialogVisible=t}}},[a("el-input",{staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"新增Zone名",disabled:!0},model:{value:e.addZoneName,callback:function(t){e.addZoneName=t},expression:"addZoneName"}}),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Zone为forward类型无需勾选",placement:"right-start"}},[a("el-checkbox",{staticStyle:{"margin-left":"20px"},attrs:{label:"新增头文件"},model:{value:e.addZoneHeader,callback:function(t){e.addZoneHeader=t},expression:"addZoneHeader"}})],1),e._v(" "),a("label",{staticClass:"zone-type-label"},[e._v("Zone类型")]),e._v(" "),a("el-select",{staticClass:"zone-type-select",attrs:{size:"small",placeholder:"Zone"},model:{value:e.addZoneType,callback:function(t){e.addZoneType=t},expression:"addZoneType"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-row",{staticStyle:{"margin-top":"10px"},attrs:{gutter:0,type:"flex"}},[a("el-col",{attrs:{span:5}},[a("span",{staticClass:"small-title"},[e._v("主机组：")]),e._v(" "),e._l(e.addZoneConf,function(t){return a("div",[a("el-checkbox",{attrs:{checked:t.use},on:{change:function(a){e.selectGroupConf(t)}}}),e._v(" "),a("span",{staticClass:"small-list-item",on:{click:function(a){e.getAddGroupConf(t.group)}}},[e._v(e._s(t.group))])],1)})],2),e._v(" "),a("el-col",{attrs:{span:20}},[a("span",{staticClass:"small-title"},[e._v("编辑主机组："+e._s(e.addGroupConf.group))]),e._v(" "),e.addGroupConf?a("el-input",{attrs:{autosize:{minRows:10},type:"textarea",spellcheck:"false",placeholder:"zone conf"},model:{value:e.addGroupConf.conf,callback:function(t){e.$set(e.addGroupConf,"conf",t)},expression:"addGroupConf.conf"}}):e._e()],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"warning"},on:{click:function(t){e.checkConf(e.addZoneConf)}}},[e._v("检 查")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitAddConf}},[e._v("保 存")])],1)],1):e._e()],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{background:"white"}},[a("div",{staticClass:"condition-div"},[a("el-input",{staticClass:"medium-input",attrs:{placeholder:"域名"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.fetchDnsLog(t):null}},model:{value:e.domain,callback:function(t){e.domain=t},expression:"domain"}}),e._v(" "),a("el-select",{staticClass:"medium-input",attrs:{placeholder:"类型"},on:{change:e.fetchDnsLog},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.typeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-input",{staticClass:"medium-input",attrs:{placeholder:"操作人"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.fetchDnsLog(t):null}},model:{value:e.rtx_id,callback:function(t){e.rtx_id=t},expression:"rtx_id"}}),e._v(" "),a("el-date-picker",{attrs:{type:"daterange","picker-options":e.pickerOptions,"start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd",align:"right"},on:{change:e.changeDateRange},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}}),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:e.fetchDnsLog}},[e._v("搜索")]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"0px"},attrs:{type:"warning"},on:{click:e.clearCondition}},[e._v("清除")])],1),e._v(" "),a("div",{attrs:{align:"center"}},[a("el-table",{staticClass:"dnslog-table",attrs:{data:e.dnsLog,"element-loading-text":"加载中",border:""}},[a("el-table-column",{attrs:{prop:"rtx_id",label:"操作者",width:"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"op_type",label:"类型",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.typeObj[t.row.op_type]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"op_domain",label:"域名",width:"250",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"op_before",label:"操作前",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row[t.column.property],function(t){return a("div",{attrs:{align:"left"}},[e._v("\n              "+e._s(t)+"\n          ")])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"op_after",label:"操作后",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row[t.column.property],function(t){return a("div",{attrs:{align:"left"}},[t.startsWith("http")?a("span",[a("a",{attrs:{href:t}},[e._v("gitlab链接")])]):a("span",[e._v("\n              "+e._s(t)+"\n            ")])])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"op_time",label:"操作时间",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"op_result",label:"结果",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["ok"===t.row.op_result?a("span",{staticStyle:{color:"green"}},[e._v("成功")]):"start"===t.row.op_result?a("span",{staticStyle:{color:"brown"}},[e._v("进行中")]):"wait"===t.row.op_result?a("span",{staticStyle:{color:"brown"}},[e._v("等待")]):"conf_deploy"===t.row.op_type?a("span",{staticStyle:{color:"red"},on:{click:function(a){e.retryDeploy(t.row.id)}}},[e._v("重试")]):a("span",{staticStyle:{color:"red",cursor:"pointer"},on:{click:function(a){e.getFailDetail(t.row.id)}}},[e._v("失败")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{align:"right",layout:"prev, pager, next","current-page":e.page,"page-size":e.pageSize,total:e.total},on:{"current-change":e.handleCurrentChange}})],1)])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{staticStyle:{height:"100%"}},[a("el-col",{staticStyle:{height:"100%"},attrs:{xs:4,sm:4,md:3,lg:2}},[a("div",{staticClass:"navbar"},[a("el-menu",{attrs:{"default-active":e.activeIndex},on:{select:e.handleSelect}},[a("el-menu-item",{attrs:{index:"1"}},[a("i",{staticClass:"fa fa-star",staticStyle:{width:"24px",height:"16px"}}),e._v("系统概览")]),e._v(" "),a("el-menu-item",{attrs:{index:"2"}},[a("i",{staticClass:"fa fa-circle-o",staticStyle:{width:"24px",height:"16px"}}),e._v("普通域名")]),e._v(" "),a("el-menu-item",{attrs:{index:"3"}},[a("i",{staticClass:"fa fa-viacoin",staticStyle:{width:"24px",height:"16px"}}),e._v("View域名")]),e._v(" "),a("el-menu-item",{attrs:{index:"4"}},[a("i",{staticClass:"fa fa-map",staticStyle:{width:"24px",height:"16px"}}),e._v("配置管理")]),e._v(" "),a("el-menu-item",{attrs:{index:"5"}},[a("i",{staticClass:"fa fa-cog",staticStyle:{width:"24px",height:"16px"}}),e._v("系统管理")]),e._v(" "),a("el-menu-item",{attrs:{index:"6"}},[a("i",{staticClass:"fa fa-steam",staticStyle:{width:"24px",height:"16px"}}),e._v("操作日志")])],1)],1)]),e._v(" "),a("el-col",{staticStyle:{height:"100%"},attrs:{xs:20,sm:20,md:21,lg:22}},[a("router-view")],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:0,type:"flex"}},[a("el-col",{attrs:{span:3}},[a("label",{staticClass:"large-title"},[e._v("Zone列表")]),e._v(" "),a("div",{staticClass:"list-div"},e._l(e.zoneList,function(t){return a("div",{staticClass:"list-item",domProps:{textContent:e._s(t)},on:{click:function(a){e.getZoneHeader(t)}}},[e._v("\n          "+e._s(t)+"\n        ")])}),0)]),e._v(" "),a("el-col",{attrs:{span:21}},[""!==e.curZoneName?a("div",{staticClass:"tab-panel"},[a("el-row",{attrs:{gutter:0,type:"flex"}},[a("el-col",{attrs:{span:20}},[a("div",{staticClass:"medium-title"},[a("span",[e._v("当前Zone："+e._s(e.curZoneName))])])]),e._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[a("el-button",{attrs:{size:"large"},on:{click:e.checkZoneHeader}},[e._v("检查")]),e._v(" "),a("el-button",{attrs:{size:"large",type:"warning"},on:{click:e.updateZoneHeader}},[e._v("提交")])],1)],1),e._v(" "),a("div",[""!==e.zoneHeaderContent?a("el-input",{directives:[{name:"loading",rawName:"v-loading",value:e.updateHeaderLoading,expression:"updateHeaderLoading"}],staticStyle:{"margin-top":"10px"},attrs:{type:"textarea",autosize:"",spellcheck:"false",placeholder:"zone header"},model:{value:e.zoneHeaderContent,callback:function(t){e.zoneHeaderContent=t},expression:"zoneHeaderContent"}}):e._e()],1)],1):e._e()])],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("el-tabs",{on:{"tab-click":e.handleIpTabClick},model:{value:e.ipActiveName,callback:function(t){e.ipActiveName=t},expression:"ipActiveName"}},[a("el-tab-pane",{attrs:{label:"操作",name:"operation"}},[a("div",{staticClass:"tab-panel"},[a("el-input",{staticClass:"large-input",attrs:{size:"large",placeholder:"请输入ip"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchIp(t):null}},model:{value:e.ipSearch,callback:function(t){e.ipSearch=t},expression:"ipSearch"}}),e._v(" "),a("el-button",{attrs:{size:"large"},on:{click:e.searchIp}},[e._v("搜索")]),e._v(" "),0!==e.ipStateList.length&&e.canOff?a("el-button",{attrs:{size:"large",type:"warning"},on:{click:e.switchIpToAqb}},[e._v("切换高防")]):e._e(),e._v(" "),0!==e.ipStateList.length&&e.canOff?a("el-button",{attrs:{size:"large",type:"danger"},on:{click:e.replaceIp}},[e._v("替换IP")]):e._e()],1),e._v(" "),a("div",{staticClass:"tab-panel"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.searchIpLoading,expression:"searchIpLoading"}],staticClass:"medium-table",attrs:{border:"",data:e.ipStateList}},[a("el-table-column",{attrs:{prop:"domain_name",label:"域名",width:"300px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"active",label:"IP激活运营商",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.active,function(t){return a("span",{staticClass:"table-item"},[e._v("\n                      "+e._s(t)+"\n                    ")])}),e._v(" "),0===t.row.active.length?a("span",[e._v("\n                      未激活\n                    ")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"has_aqb",label:"高防配置",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.has_aqb?a("span",[e._v("\n                      有\n                    ")]):a("span",{staticStyle:{color:"red"}},[e._v("\n                      无\n                    ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"only_record",label:"唯一解析",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.only_record?a("span",{staticStyle:{color:"red"}},[e._v("\n                      是\n                    ")]):a("span",[e._v("\n                      否\n                    ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"has_switched",label:"替换状态",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["forbid"===t.row.has_switched?a("span",{staticStyle:{color:"red"}},[e._v("\n                      已禁用\n                    ")]):e._e(),e._v(" "),"replace"===t.row.has_switched?a("span",{staticStyle:{color:"red"}},[e._v("\n                      已替换\n                    ")]):e._e(),e._v(" "),"no_switch"===t.row.has_switched?a("span",[e._v("\n                      无\n                    ")]):e._e()]}}])})],1)],1)]),e._v(" "),a("el-tab-pane",{staticClass:"tab-panel",attrs:{label:"记录",name:"record"}},[a("el-table",{attrs:{border:"",data:e.switchHistory}},[a("el-table-column",{attrs:{prop:"id",label:"序号",width:"80px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"rtx_id",label:"操作人",width:"150px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"update_at",label:"时间",width:"200px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"switch_ip",label:"切换IP",width:"240px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"switch_type",label:"操作类型",width:"240px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["aqb"===t.row.switch_type?a("span",[e._v("切换高防")]):e._e(),e._v(" "),"replace"===t.row.switch_type&&""===t.row.switch_to?a("span",[e._v("禁用IP")]):e._e(),e._v(" "),"replace"===t.row.switch_type&&""!==t.row.switch_to?a("span",[e._v("替换IP")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"switch_to",label:"切换后",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["aqb"===t.row.switch_to?a("span",[e._v("高防配置")]):e._e(),e._v(" "),"replace"===t.row.switch_type&&""===t.row.switch_to?a("span",[e._v("禁用IP")]):e._e(),e._v(" "),"replace"===t.row.switch_type&&""!==t.row.switch_to?a("span",[e._v(e._s(t.row.switch_to))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"state",label:"切换状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["switched"===t.row.state?a("span",{staticStyle:{color:"blue"}},[e._v("已切换")]):e._e(),e._v(" "),"recovered"===t.row.state?a("span",[e._v("已恢复")]):e._e()]}}])}),e._v(">\n          "),a("el-table-column",{attrs:{prop:"operation",label:"操作",width:"250px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["switched"===t.row.state&&"aqb"===t.row.switch_type?a("el-button",{attrs:{size:"small",type:"info",disabled:"recovered"===t.row.state},on:{click:function(a){e.switchIpFromAqb(t.row.id)}}},[e._v("\n                取消高防\n              ")]):e._e(),e._v(" "),"switched"===t.row.state&&"replace"===t.row.switch_type&&""!==t.row.switch_to?a("el-button",{attrs:{size:"small",type:"info",disabled:"recovered"===t.row.state},on:{click:function(a){e.cancelReplaceIp(t.row.id)}}},[e._v("\n                取消替换\n              ")]):e._e(),e._v(" "),"switched"===t.row.state&&"replace"===t.row.switch_type&&""===t.row.switch_to?a("el-button",{attrs:{size:"small",type:"info",disabled:"recovered"===t.row.state},on:{click:function(a){e.cancelReplaceIp(t.row.id)}}},[e._v("\n                取消禁用\n              ")]):e._e(),e._v(" "),"aqb"===t.row.switch_type?a("el-button",{attrs:{size:"small"},on:{click:function(a){e.viewSwitchDetail(t.row.id)}}},[e._v("\n                查看\n              ")]):e._e(),e._v(" "),"recovered"===t.row.state&&"replace"===t.row.switch_type?a("span",[e._v("无操作")]):e._e()]}}])})],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"高防配置切换",visible:e.aqbVisible},on:{"update:visible":function(t){e.aqbVisible=t}}},[a("span",[0===e.noAqbList.length?a("div",[e._v("切换成功！")]):e._e(),e._v(" "),0!==e.noAqbList.length?a("div",[e._v("以下域名高防未配置：")]):e._e(),e._v(" "),e._l(e.noAqbList,function(t){return a("div",[a("div",{staticStyle:{width:"30px","margin-top":"5px"}},[e._v(e._s(t))])])})],2),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleCloseAqbDialog}},[e._v("确定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"IP替换",visible:e.ipVisible},on:{"update:visible":function(t){e.ipVisible=t}}},[a("el-input",{staticStyle:{display:"inline-block"},attrs:{placeholder:"请输入替换ip,为空即禁用该IP."},model:{value:e.switchTo,callback:function(t){e.switchTo=t},expression:"switchTo"}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleCloseIpDialog}},[e._v("替换")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"切换详情",visible:e.detailVisible,width:"90%"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("el-table",{staticStyle:{"margin-top":"5px"},attrs:{data:e.switchDetails}},[a("el-table-column",{attrs:{prop:"domain_name",label:"域名",width:"350px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"isp",label:"运营商",width:"150px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"before_enabled_server_rooms",label:"切换前机房",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"before_state",label:"切换前状态ID",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"after_state",label:"切换后状态ID",align:"center"}})],1),e._v(" "),a("el-pagination",{attrs:{align:"right",layout:"prev, pager, next","current-page":e.detailPage,"page-size":e.detailPageSize,total:e.detailTotal},on:{"current-change":e.handleDetailChange}})],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tab-panel"},[a("div",{staticClass:"tab-panel"},[a("el-row",[a("el-col",{attrs:{span:16}},[a("div",{staticClass:"grid-content"},[a("el-select",{attrs:{clearable:"",size:"large",placeholder:"请选择"},model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},e._l(e.searchOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-input",{staticClass:"large-input",attrs:{size:"large"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchGeneral(t):null}},model:{value:e.searchCondition,callback:function(t){e.searchCondition=t},expression:"searchCondition"}}),e._v(" "),a("el-button",{attrs:{size:"large",type:"primary"},on:{click:e.searchGeneral}},[e._v("搜索")])],1)]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("el-button",{staticStyle:{display:"inline-block","margin-left":"2px"},attrs:{size:"large"},on:{click:function(t){e.addSubnetVisible=!0}}},[e._v("新建子网")])],1)])],1)],1),e._v(" "),a("hr"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingSubnet,expression:"loadingSubnet"}],staticClass:"medium-table",attrs:{border:"",height:"600",data:e.subnetsList}},[a("el-table-column",{attrs:{prop:"region_name",label:"区域",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"subnet",label:"子网",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"intranet",label:"类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.intranet?a("span",[e._v("私网")]):a("span",[e._v("公网")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"create_user",label:"创建用户",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"comment",label:"备注",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"operation",label:"操作",width:"300px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"info",size:"small",plain:!0},on:{click:function(a){e.fetchSubnetIp(t.row.region_name)}}},[e._v("IP详情")]),e._v(" "),a("el-button",{attrs:{type:"warning",size:"small",plain:!0},on:{click:function(a){e.openRenameDialog(t.row.region_name)}}},[e._v("重命名")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small",plain:!0},on:{click:function(a){e.deleteSubnet(t.row.region_name,t.row.subnet)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"重命名子网",visible:e.renameSubnetVisible,width:"40%"},on:{"update:visible":function(t){e.renameSubnetVisible=t}}},[a("el-form",{ref:"renameForm",attrs:{"label-position":"left",model:e.renameForm,"label-width":"120px",rules:e.subnetRules}},[a("el-form-item",{attrs:{label:"原子网名称"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.renameForm.oldRegion,callback:function(t){e.$set(e.renameForm,"oldRegion",t)},expression:"renameForm.oldRegion"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"修改后子网名称",prop:"newRegion"}},[a("el-input",{model:{value:e.renameForm.newRegion,callback:function(t){e.$set(e.renameForm,"newRegion",t)},expression:"renameForm.newRegion"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.renameSubnetVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.renameSubnet}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新增子网",visible:e.addSubnetVisible,width:"40%"},on:{"update:visible":function(t){e.addSubnetVisible=t}}},[a("el-form",{ref:"subnetForm",attrs:{"label-position":"left",model:e.subnetForm,"label-width":"80px",rules:e.subnetRules}},[a("el-form-item",{attrs:{label:"名称",prop:"region"}},[a("el-input",{model:{value:e.subnetForm.region,callback:function(t){e.$set(e.subnetForm,"region",t)},expression:"subnetForm.region"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"子网",prop:"subnet"}},[a("el-input",{model:{value:e.subnetForm.subnet,callback:function(t){e.$set(e.subnetForm,"subnet",t)},expression:"subnetForm.subnet"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"机房",prop:"colo"}},[a("el-select",{attrs:{clearable:"",size:"large"},model:{value:e.subnetForm.colo,callback:function(t){e.$set(e.subnetForm,"colo",t)},expression:"subnetForm.colo"}},e._l(e.coloOpions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:e.subnetForm.comment,callback:function(t){e.$set(e.subnetForm,"comment",t)},expression:"subnetForm.comment"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.clearSubnetForm}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addSubnet}},[e._v("提 交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"子网详情",visible:e.SubnetDetailVisible,width:"50%"},on:{"update:visible":function(t){e.SubnetDetailVisible=t}}},[a("el-table",{staticClass:"medium-table",attrs:{height:"500",data:e.ipList}},[a("el-table-column",{attrs:{prop:"ip",label:"IP",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ipStatus",label:"IP状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.domain?a("div",{staticStyle:{color:"red"}},[e._v("\n            使用\n          ")]):a("div",{staticStyle:{color:"green"}},[e._v("\n            可用\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"domain",label:"域名",align:"center"}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.SubnetDetailVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.body",value:e.fullScreenLoading,expression:"fullScreenLoading",modifiers:{body:!0}}]},[a("div",{staticClass:"tab-panel"},[a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[a("el-input",{staticClass:"xlarge-input",attrs:{size:"large",placeholder:"请输入域名"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.viewDomainList(t):null}},model:{value:e.domainName,callback:function(t){e.domainName=t},expression:"domainName"}}),e._v(" "),a("el-button",{attrs:{size:"large",type:"primary",icon:"search"},on:{click:e.viewDomainList}},[e._v("搜索")])],1)]),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[a("el-button",{attrs:{size:"large",type:"primary"},on:{click:e.handleAddDomain}},[e._v("新增域名")])],1)])],1),e._v(" "),a("div",{staticClass:"option-div"},[a("label",{staticClass:"option-title"},[e._v("机房:")]),e._v(" "),a("el-checkbox-group",{staticStyle:{display:"inline-block"},on:{change:e.handleCheckedRoomsChange},model:{value:e.checkedServerRooms,callback:function(t){e.checkedServerRooms=t},expression:"checkedServerRooms"}},e._l(e.serverRooms,function(t){return a("el-checkbox",{key:t,staticClass:"option-item",attrs:{label:t}},[a("span",{staticClass:"option-item-text"},[e._v(e._s(t))])])}),1),e._v(" "),a("el-checkbox",{staticClass:"option-item",model:{value:e.selectCdn,callback:function(t){e.selectCdn=t},expression:"selectCdn"}},[a("span",{staticClass:"option-item-text"},[e._v("CDN")])]),e._v(" "),a("el-checkbox",{staticClass:"option-item",attrs:{indeterminate:e.isSeverRoomsIndeterminate},on:{change:e.handleCheckAllServerRoomChange},model:{value:e.checkAllServerRooms,callback:function(t){e.checkAllServerRooms=t},expression:"checkAllServerRooms"}},[a("span",{staticClass:"option-item-text"},[e._v("全选")])])],1),e._v(" "),a("div",{staticClass:"option-div"},[a("label",{staticClass:"option-title"},[e._v("运营商:")]),e._v(" "),a("el-checkbox-group",{staticStyle:{display:"inline-block"},on:{change:e.handleCheckedIspsChange},model:{value:e.checkedIsps,callback:function(t){e.checkedIsps=t},expression:"checkedIsps"}},e._l(e.isps,function(t){return a("el-checkbox",{key:t.name_in_english,staticClass:"option-item",attrs:{label:t.name_in_english}},[a("span",{staticClass:"option-item-text"},[e._v(e._s(t.name_in_chinese))])])}),1),e._v(" "),a("el-checkbox",{staticClass:"option-item",attrs:{indeterminate:e.isIspsIndeterminate},on:{change:e.handleCheckAllIspsChange},model:{value:e.checkAllIsps,callback:function(t){e.checkAllIsps=t},expression:"checkAllIsps"}},[a("span",{staticClass:"option-item-text"},[e._v("全选")])])],1)],1),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"tab-panel"},[a("el-row",{attrs:{gutter:0,type:"flex"}},[a("el-col",{attrs:{span:4}},[e.domainList.length>0?a("label",{staticClass:"large-title"},[e._v("域名列表")]):e._e(),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingDomainList,expression:"loadingDomainList"}],attrs:{"element-loading-text":"加载中"}},e._l(e.domainListPage,function(t){return a("div",{key:t.domain,staticClass:"list-item",domProps:{textContent:e._s(t.domain)},on:{click:function(a){e.viewDomain(t.domain)}}})}),0),e._v(" "),e.domainList.length>0?a("div",{staticStyle:{float:"right"}},[a("el-pagination",{attrs:{small:"",layout:"prev, pager, next","current-page":e.page,"page-size":e.pageSize,total:e.domainListTotal},on:{"current-change":e.handleCurrentChange}})],1):e._e()]),e._v(" "),a("el-col",{staticStyle:{"margin-left":"10px"},attrs:{span:20}},[""!==e.stateDomainName?a("div",[a("el-row",{attrs:{gutter:0,type:"flex"}},[a("el-col",{attrs:{span:16}},[a("span",{staticClass:"medium-title"},[e._v("当前域名："+e._s(e.stateDomainName))]),e._v(" "),e.isMigrate?a("span",{staticClass:"medium-title"},[e._v("(已迁移)")]):e._e(),e._v(" "),a("el-button",{attrs:{size:"large"},on:{click:e.handelEditDomain}},[e._v("修改域名")]),e._v(" "),a("el-button",{attrs:{size:"large",type:"danger",plain:""},on:{click:e.deleteDomain}},[e._v("删除域名")])],1),e._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:8}},[a("el-button",{attrs:{size:"large"},on:{click:function(t){e.viewDomain(e.stateDomainName)}}},[e._v("刷新")]),e._v(" "),a("el-button",{attrs:{size:"large",type:"warning"},on:{click:e.submitModify}},[e._v("提交")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingDomainInfo,expression:"loadingDomainInfo"}],staticClass:"large-table",staticStyle:{"margin-top":"10px"},attrs:{"element-loading-text":"加载中",border:"",data:e.stateDomainInfo}},[a("el-table-column",{attrs:{prop:"info",label:"机房",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["cdn"!==t.row.info.name?a("div",{staticStyle:{"padding-top":"10px","padding-bottom":"10px"}},[a("span",[a("label",[e._v(e._s(t.row[t.column.property].name)),a("br")])]),e._v(" "),a("el-switch",{attrs:{"active-text":"","inactive-text":"","active-color":"#13ce66"},on:{change:function(a){e.switchAll(t.$index,t.row[t.column.property].is_enabled)}},model:{value:t.row[t.column.property].is_enabled,callback:function(a){e.$set(t.row[t.column.property],"is_enabled",a)},expression:"scope.row[scope.column.property].is_enabled"}})],1):a("div",{staticStyle:{"padding-top":"10px","padding-bottom":"10px"}},[a("span",[a("label",[e._v("CDN")])])])]}}])}),e._v(" "),e._l(e.isps,function(t){return a("el-table-column",{key:t.name_in_english,attrs:{prop:t.name_in_english,label:t.name_in_chinese,align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["cdn"!==t.row.info.name?a("div",{staticStyle:{"padding-top":"5px","padding-bottom":"5px"}},[e._l(t.row[t.column.property].ips,function(t){return a("span",{key:t},[a("label",[e._v(e._s(t)),a("br")])])}),e._v(" "),a("el-switch",{attrs:{"active-text":"","inactive-text":"","active-color":"#13ce66"},on:{change:function(a){e.switchCn(t.column.property,t.row[t.column.property].is_enabled)}},model:{value:t.row[t.column.property].is_enabled,callback:function(a){e.$set(t.row[t.column.property],"is_enabled",a)},expression:"scope.row[scope.column.property].is_enabled"}})],2):e._e(),e._v(" "),"cdn"===t.row.info.name?a("div",[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(a){e.switchCdn(t.column.property,t.row[t.column.property].name)}},model:{value:t.row[t.column.property].name,callback:function(a){e.$set(t.row[t.column.property],"name",a)},expression:"scope.row[scope.column.property].name"}},e._l(e.stateDomainCdn,function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}),1)],1):e._e()]}}])})})],2)],1):e._e()])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.addDialogTitle,visible:e.addDomainvisible},on:{"update:visible":function(t){e.addDomainvisible=t}}},[a("div",[a("el-input",{staticClass:"large-input",attrs:{size:"large",placeholder:"新增域名"},on:{blur:function(t){e.domainName=e.domainName.trim()}},model:{value:e.addDomainName,callback:function(t){e.addDomainName=t},expression:"addDomainName"}})],1),e._v(" "),0!=e.addDomainInfo.length?a("div",{directives:[{name:"loading",rawName:"v-loading.body",value:e.addDialogLoading,expression:"addDialogLoading",modifiers:{body:!0}}]},[a("el-table",{staticClass:"small-table",attrs:{data:e.addDomainInfo,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"属性",align:"center",width:"120px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"conf",label:"配置"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._l(t.row.conf,function(n){return a("el-tag",{key:"value",staticClass:"item-tag",attrs:{closable:!0,"close-transition":!0},on:{close:function(a){e.handleDeleteConf(t.$index,n)}}},["CDN"===t.row.name?a("span",[e._v("\n                  "+e._s(n.name+":"+n.cname)+"\n                ")]):a("span",[e._v("\n                  "+e._s(n)+"\n                ")])])}),e._v(" "),t.row.showInput?a("el-input",{ref:"saveTagInput",staticClass:"large-input",attrs:{size:"small",placeholder:"输入ip"},on:{blur:function(e){t.row.showInput=!1}},nativeOn:{keyup:function(a){if(!("button"in a)&&e._k(a.keyCode,"enter",13,a.key,"Enter"))return null;e.handleInputConfirm(t.$index)}},model:{value:t.row.inputValue,callback:function(a){e.$set(t.row,"inputValue",a)},expression:"scope.row.inputValue"}}):a("el-button",{attrs:{size:"small"},on:{click:function(a){e.handleShowInput(t.$index)}}},[e._v("\n                添加\n              ")])],2)]}}])})],1)],1):e._e(),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleCancelAdd}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addDomainSubmit}},[e._v("提交")])],1)])],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"migrate"},[a("div",{staticClass:"tab-panel"},[a("el-row",[a("el-col",{attrs:{span:15}},[a("div",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"迁移机房",size:"small"}},[a("el-select",{attrs:{multiple:"",clearable:"","collapse-tags":e.srcRoomsChecked.length>6},model:{value:e.srcRoomsChecked,callback:function(t){e.srcRoomsChecked=t},expression:"srcRoomsChecked"}},e._l(e.ColoOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"运营商",size:"small"}},[a("el-select",{attrs:{multiple:"",clearable:"","collapse-tags":e.ispsChecked.length>4},on:{change:e.handleMigrateIspChange},model:{value:e.ispsChecked,callback:function(t){e.ispsChecked=t},expression:"ispsChecked"}},e._l(e.IspOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"目的机房",size:"small"}},[a("el-select",{attrs:{multiple:"",clearable:""},model:{value:e.dstRoomsChecked,callback:function(t){e.dstRoomsChecked=t},expression:"dstRoomsChecked"}},e._l(e.ColoOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:e.srcRoomsChecked.indexOf(t.value)>=0}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{size:"small"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.listMigrateDomain}},[e._v("预览")])],1),e._v(" "),a("el-form-item",{attrs:{size:"small"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.migrateRooms}},[e._v("迁移")])],1)],1)],1)]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",[a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"small",type:"danger"},on:{click:e.onekeyRecoverRooms}},[e._v("\n          一键恢复\n        ")])],1)])],1)],1),e._v(" "),"domains"===e.showTable?a("div",{staticClass:"tab-panel"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.migrateListLoading,expression:"migrateListLoading"}],key:"migrateDomainList",attrs:{border:"",data:e.migrateDomainList}},[a("el-table-column",{attrs:{prop:"domain_name",label:"域名",width:"400px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cur",label:"需迁移机房",width:"200px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"after",label:"迁移后机房",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[""===t.row.after?a("span",{staticStyle:{color:"red"}},[e._v("无迁移机房")]):a("span",{staticStyle:{color:"green"}},[e._v(e._s(t.row.after))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"isps",label:"迁移运营商",width:"300px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.isps,function(t){return a("span",{staticClass:"isp"},[e._v("\n            "+e._s(t)+"\n          ")])})}}])})],1)],1):e._e(),e._v(" "),"history"===e.showTable?a("div",{staticClass:"tab-panel"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.migrateListLoading,expression:"migrateListLoading"}],key:"migrateHistoryInfo",attrs:{border:"",data:e.migrateHistoryInfo}},[a("el-table-column",{attrs:{label:"迁移机房",prop:"migrate_rooms"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.migrate_rooms,function(t){return a("span",{key:t},[e._v("\n            "+e._s(t)+"\n          ")])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:"迁移运营商",prop:"migrated"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.migrate_isps,function(t){return a("span",{key:t},[e._v("\n            "+e._s(t)+"\n          ")])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:"目标机房",prop:"dst_rooms"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.dst_rooms,function(t){return a("span",{key:t},[e._v("\n            "+e._s(t)+"\n          ")])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"state",label:"状态",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["migrating"===t.row.state?a("span",{staticStyle:{color:"brown"}},[e._v("迁移中")]):e._e(),e._v(" "),"error"===t.row.state?a("span",{staticStyle:{color:"red"}},[e._v("异常")]):e._e(),e._v(" "),"migrated"===t.row.state?a("span",{staticStyle:{color:"green"}},[e._v("迁移完成")]):e._e(),e._v(" "),"recovered"===t.row.state?a("span",{staticStyle:{color:"green"}},[e._v("已恢复")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"progress",label:"进度",width:"300px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-progress",{attrs:{"stroke-width":18,"text-inside":!0,percentage:Math.round(t.row.cur/t.row.all*100),status:e.getStatus(t.row.cur,t.row.all,t.row.state)}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){e.viewPagedDetail(t.row.id)}}},[e._v("\n              详情\n            ")])]}}])})],1)],1):e._e(),e._v(" "),"ispstatus"===e.showTable?a("div",{staticClass:"tab-panel"},[a("el-table",{attrs:{border:"",data:e.ispStatus}},[a("el-table-column",{attrs:{prop:"room",label:"机房",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"isp",label:"运营商",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"is_health",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.is_health?a("span",{staticStyle:{color:"green"}},[e._v("正常")]):a("span",{staticStyle:{color:"red"}},[e._v("维护")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"维护时间",align:"center"}})],1)],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"迁移详情",visible:e.detailDialogVisible,width:"90%"},on:{"update:visible":function(t){e.detailDialogVisible=t}}},[a("el-row",{attrs:{gutter:0,type:"flex"}},[a("el-col",{attrs:{span:20}},[a("span",[e._v("目标机房：")]),e._v(" "),a("span",[e._v(e._s(e.migrateRules))])]),e._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[a("el-input",{staticClass:"medium-input",attrs:{placeholder:"请输入域名"},model:{value:e.detailDomain,callback:function(t){e.detailDomain=t},expression:"detailDomain"}}),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:e.viewPagedDetail}},[e._v("搜索")])],1)],1),e._v(" "),a("el-table",{staticStyle:{"margin-top":"5px"},attrs:{data:e.migrateDetails}},[a("el-table-column",{attrs:{prop:"domain_name",label:"域名",width:"350px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"isp",label:"运营商",width:"150px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"before_enabled_server_rooms",label:"迁移前",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"after_enabled_server_rooms",label:"迁移后",align:"center"}})],1),e._v(" "),a("el-pagination",{attrs:{align:"right",layout:"prev, pager, next","current-page":e.page,"page-size":e.pageSize,total:e.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"迁移进度",visible:e.migrateProcessDialogVisible,width:"60%"},on:{"update:visible":function(t){e.migrateProcessDialogVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.migrateHistoryInfo}},[a("el-table-column",{attrs:{label:"迁移机房",prop:"migrate_rooms"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.migrate_rooms,function(t){return a("span",{key:t},[e._v("\n            "+e._s(t)+"\n          ")])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:"迁移运营商",prop:"migrated"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.migrate_isps,function(t){return a("span",{key:t},[e._v("\n            "+e._s(t)+"\n          ")])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:"目标机房",prop:"dst_rooms"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.dst_rooms,function(t){return a("span",{key:t},[e._v("\n            "+e._s(t)+"\n          ")])})}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"state",label:"状态",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["migrating"===t.row.state?a("span",{staticStyle:{color:"brown"}},[e._v("迁移中")]):e._e(),e._v(" "),"error"===t.row.state?a("span",{staticStyle:{color:"red"}},[e._v("异常")]):e._e(),e._v(" "),"migrated"===t.row.state?a("span",{staticStyle:{color:"green"}},[e._v("迁移完成")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"progress",label:"进度",width:"300px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-progress",{attrs:{"stroke-width":18,"text-inside":!0,percentage:Math.round(t.row.cur/t.row.all*100),status:e.getStatus(t.row.cur,t.row.all,t.row.state)}})]}}])})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.migrateProcessDialogVisible=!1,e.migrateHistoryInfo=[]}}},[e._v("关闭")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.migrateProcessDialogVisible=!1,e.migrateHistoryInfo=[]}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("body",[a("div",[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticClass:"tab-panel",attrs:{label:"主机管理",name:"host"}},[a("HostManager")],1),e._v(" "),a("el-tab-pane",{staticClass:"tab-panel",attrs:{label:"Zone管理",name:"zone"}},[a("ZoneManager")],1),e._v(" "),a("el-tab-pane",{staticClass:"tab-panel",attrs:{label:"Header编辑",name:"header"}},[a("HeaderEdit")],1)],1)],1)])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{type:"info"},on:{click:function(t){e.addHostGroupVisible=!0}}},[e._v("新增主机组")]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:e.fetchHostGroupList}},[e._v("刷新")]),e._v(" "),a("el-table",{staticStyle:{width:"90%"},attrs:{data:e.hostGroupList,height:"500"}},[a("el-table-column",{attrs:{label:"主机组",align:"center"}},[a("el-table-column",{attrs:{type:"expand",label:"主机",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-table",{staticClass:"medium-table",attrs:{border:"",data:t.row.hosts}},[a("el-table-column",{attrs:{prop:"host_name",label:"主机名",width:"300px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"host_ip",label:"IP",width:"200px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"host_conf_md5",label:"配置md5",align:"center"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"名称",prop:"group_name",width:"100px"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.handleDeleteGroup(t.row.group_name)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.handleEditGroup(t.row.group_name,t.row.hosts)}}},[e._v("编辑主机")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"primary",disabled:!t.row.has_conf},on:{click:function(a){e.getNamedConfHeader(t.row.group_name)}}},[e._v("编辑配置")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"reload管理",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Reload关闭后修改dns记录及配置将不会生效",placement:"right-start"}},[a("el-switch",{attrs:{"active-text":"","inactive-text":"","active-color":"#13ce66"},on:{change:function(a){e.setGroupReloadStatus(t.row)}},model:{value:t.row.reload_status,callback:function(a){e.$set(t.row,"reload_status",a)},expression:"scope.row.reload_status"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"配置md5",prop:"conf_md5"}})],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading.body",value:e.namedConfLoading,expression:"namedConfLoading",modifiers:{body:!0}}],attrs:{title:"配置编辑",visible:e.namedConfDialogVisible,width:"90"},on:{"update:visible":function(t){e.namedConfDialogVisible=t}}},[a("el-row",{attrs:{gutter:0,type:"flex"}},[a("el-col",{attrs:{span:20}},[a("span",{staticClass:"small-title"},[e._v("当前主机组："+e._s(e.curHostGroupName))])]),e._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[a("el-button",{staticClass:"button",attrs:{size:"small"},on:{click:function(t){e.requestNamedConfHeader(e.curHostGroupName)}}},[e._v("重载")]),e._v(" "),a("el-button",{staticClass:"button",attrs:{size:"small",type:"danger"},on:{click:e.updateNamedConfHeader}},[e._v("保存")])],1)],1),e._v(" "),a("el-input",{attrs:{autosize:{minRows:10},type:"textarea",spellcheck:"false",placeholder:"named.conf"},model:{value:e.namedConf,callback:function(t){e.namedConf=t},expression:"namedConf"}})],1),e._v(" "),a("el-dialog",{attrs:{title:"新增主机组",visible:e.addHostGroupVisible,width:"90"},on:{"update:visible":function(t){e.addHostGroupVisible=t}}},[a("el-form",{ref:"addGroupForm",attrs:{inline:!0,model:e.addGroupForm,rules:e.groupRules},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"主机组名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"xxxMaster/xxxSlave"},model:{value:e.addGroupForm.name,callback:function(t){e.$set(e.addGroupForm,"name",t)},expression:"addGroupForm.name"}})],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.addHostArray.data,border:"","highlight-current-row":""}},[e._l(e.addHostArray.columns,function(t){return a("el-table-column",{key:t.field,attrs:{prop:t.field,label:t.title},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row.isSet?a("span",[a("el-input",{attrs:{size:"medium"},model:{value:e.addHostArray.sel[t.field],callback:function(a){e.$set(e.addHostArray.sel,t.field,a)},expression:"addHostArray.sel[v.field]"}})],1):a("span",[e._v(e._s(n.row[t.field]))])]}}])})}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isSet?a("span",{staticClass:"el-tag el-tag--info el-tag--medium",staticStyle:{cursor:"pointer"},on:{click:function(a){e.handleSaveHost(t.row,t.$index)}}},[e._v("\n                保存\n              ")]):a("span",{staticClass:"el-tag el-tag--info el-tag--medium",staticStyle:{cursor:"pointer"},on:{click:function(a){e.handleModifyHost(t.row,t.$index)}}},[e._v("\n                修改\n              ")]),e._v(" "),t.row.isSet?a("span",{staticClass:"el-tag  el-tag--medium",staticStyle:{cursor:"pointer"},on:{click:function(a){e.handleCancelChange(t.row,t.$index)}}},[e._v("\n                  取消\n              ")]):a("span",{staticClass:"el-tag el-tag--danger el-tag--medium",staticStyle:{cursor:"pointer"},on:{click:function(a){e.handleDeleteHost(t.$index)}}},[e._v("\n                  删除\n              ")])]}}])})],2),e._v(" "),a("div",{staticClass:"el-table-add-row",staticStyle:{width:"100%"},on:{click:e.handleAddHost}},[a("span",[e._v("+ 添加")])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.clearHostGroupInfo}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitAddHostGroup}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.editGroupTitle,visible:e.editHostGroupVisible,width:"90"},on:{"update:visible":function(t){e.editHostGroupVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.editHostArray.data,border:"","highlight-current-row":""}},[e._l(e.editHostArray.columns,function(t){return a("el-table-column",{key:t.field,attrs:{prop:t.field,label:t.title},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row.isSet?a("span",[a("el-input",{attrs:{size:"medium"},model:{value:e.editHostArray.sel[t.field],callback:function(a){e.$set(e.editHostArray.sel,t.field,a)},expression:"editHostArray.sel[v.field]"}})],1):a("span",[e._v(e._s(n.row[t.field]))])]}}])})}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isSet?a("span",{staticClass:"el-tag el-tag--info el-tag--medium",staticStyle:{cursor:"pointer"},on:{click:function(a){e.submitHost(t.row,t.$index)}}},[e._v("\n                提交\n              ")]):e._e(),e._v(" "),t.row.isSet?a("span",{staticClass:"el-tag el-tag--info el-tag--medium",staticStyle:{cursor:"pointer"},on:{click:function(a){e.editHostArray.data.splice(t.$index,1)}}},[e._v("\n                取消\n              ")]):e._e(),e._v(" "),t.row.isSet?e._e():a("span",{staticClass:"el-tag el-tag--danger el-tag--medium",staticStyle:{cursor:"pointer"},on:{click:function(a){e.submitDeleteHost(t.row.host_name,t.$index)}}},[e._v("\n                删除\n              ")])]}}])})],2),e._v(" "),a("div",{staticClass:"el-table-add-row",staticStyle:{width:"100%"},on:{click:e.handleAddHostForModify}},[a("span",[e._v("+ 添加")])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.clearModifyGroupInfo}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.clearModifyGroupInfo}},[e._v("完成")])],1)],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"preview"},[a("div",{staticClass:"preview-panel"},[a("span",{staticClass:"title"},[e._v("已迁移机房:")]),e._v(" "),0===e.migrateHistory.length?a("span",{staticClass:"title"},[e._v("无")]):e._e(),e._v(" "),e.migrateHistory.length>0?a("div",{staticClass:"tab-panel"},[a("el-table",{staticClass:"medium-table",attrs:{border:"",data:e.migrateHistory}},[a("el-table-column",{attrs:{prop:"migrate_rooms",label:"迁移机房",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"migrate_isps",label:"迁移运营商",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"dst_rooms",label:"目标机房",align:"center"}})],1)],1):e._e()]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"preview-panel"},[a("span",{staticClass:"title"},[e._v("已迁移ACL:")]),e._v(" "),0===e.aclMigrateHistory.length?a("span",{staticClass:"title"},[e._v("无")]):e._e(),e._v(" "),e.aclMigrateHistory.length>0?a("div",{staticClass:"tab-panel"},[a("el-table",{staticClass:"medium-table",attrs:{border:"",data:e.aclMigrateHistory}},[a("el-table-column",{attrs:{prop:"subnet",label:"网段",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"所属运营商",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"demonstration"},[e._v(" "+e._s(e.viewIspDict[t.row.origin_acl])+" ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"当前运营商",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"demonstration"},[e._v(" "+e._s(e.viewIspDict[t.row.now_acl])+" ")])]}}])})],1)],1):e._e()]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"preview-panel"},[a("span",{staticClass:"title"},[e._v("域名统计")]),e._v(" "),e.domainCount.length>0?a("div",{staticClass:"tab-panel"},[a("el-table",{staticClass:"medium-table",attrs:{border:"",data:e.domainCount}},[a("el-table-column",{attrs:{prop:"zone",label:"Zone"}}),e._v(" "),a("el-table-column",{attrs:{prop:"count",label:"域名数",align:"center"}})],1)],1):e._e()])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleTabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"域名管理",name:"record"}},[a("RecordManager")],1),e._v(" "),a("el-tab-pane",{attrs:{label:"子网管理",name:"subnet"}},[a("SubnetManager")],1)],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"域名管理",name:"domain"}},[a("DomainManager")],1),e._v(" "),a("el-tab-pane",{attrs:{label:"迁移管理",name:"migrate"}},[a("Migrate")],1),e._v(" "),a("el-tab-pane",{attrs:{label:"运营商管理",name:"isp"}},[a("IspManager")],1),e._v(" "),a("el-tab-pane",{attrs:{label:"ACL管理",name:"acl"}},[a("AclManager")],1)],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("header",[a("div",[e._m(0),e._v(" "),a("div",{staticClass:"user"},[a("i",{staticClass:"fa fa-user"}),e._v(" "),a("span",[e._v(e._s(e.userName))]),e._v(" "),a("span",{staticStyle:{color:"white","margin-left":"10px",cursor:"pointer"},on:{click:e.logout}},[e._v("注销")])])])]),e._v(" "),a("body",[a("router-view")],1)])},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title"},[a("i",{staticClass:"fa fa-cloud"}),e._v(" "),a("span",[e._v("DNSDB")])])}]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tab-panel"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.editIspArray.data,border:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"运营商",align:"center"}},[e._l(e.editIspArray.columns,function(t){return a("el-table-column",{key:t.field,attrs:{prop:t.field,label:t.title},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row.isSet?a("span",[a("el-input",{attrs:{size:"medium"},model:{value:e.editIspArray.sel[t.field],callback:function(a){e.$set(e.editIspArray.sel,t.field,a)},expression:"editIspArray.sel[v.field]"}})],1):a("span",[e._v(e._s(n.row[t.field]))])]}}])})}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isSet?a("span",{staticClass:"el-tag el-tag--info el-tag--medium",staticStyle:{cursor:"pointer"},on:{click:function(a){e.submitIsp(t.row,t.$index)}}},[e._v("\n                  提交\n                ")]):e._e(),e._v(" "),t.row.isSet?a("span",{staticClass:"el-tag el-tag--info el-tag--medium",staticStyle:{cursor:"pointer"},on:{click:function(a){e.handleCancelIsp(t.row,t.$index)}}},[e._v("\n                  取消\n                ")]):e._e(),e._v(" "),t.row.isSet?e._e():a("span",{staticClass:"el-tag el-tag--danger el-tag--medium",staticStyle:{cursor:"pointer"},on:{click:function(a){e.submitDeleteIsp(t.row.name_in_english,t.$index)}}},[e._v("\n                  删除\n                ")])]}}])})],2)],1),e._v(" "),a("div",{staticClass:"el-table-add-row",staticStyle:{width:"100%"},on:{click:e.handleAddIsp}},[a("span",[e._v("+ 添加")])])],1)])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tab-panel"},[a("div",[a("el-row",[a("el-col",{attrs:{span:16}},[a("div",{staticClass:"grid-content"},[a("el-select",{attrs:{clearable:"",size:"large",placeholder:"请选择"},on:{change:function(t){e.searchCondition=""}},model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},e._l(e.typeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-input",{staticClass:"large-input",attrs:{size:"large"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchGeneral(t):null}},model:{value:e.searchCondition,callback:function(t){e.searchCondition=t},expression:"searchCondition"}}),e._v(" "),a("el-button",{attrs:{size:"large",type:"primary"},on:{click:e.searchGeneral}},[e._v("搜索")])],1)]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("el-button",{staticStyle:{display:"inline-block","margin-left":"2px"},attrs:{size:"large"},on:{click:function(t){e.addRecordVisible=!0}}},[e._v("新增域名")])],1)])],1)],1),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"tab-panel"},[a("el-table",{attrs:{data:e.recordList}},[a("el-table-column",{attrs:{prop:"domain_name",label:"域名",width:"300px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"record_type",label:"类型",width:"100px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"record",label:"记录",width:"200px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ttl",label:"TTL",width:"100px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.ttl?a("span",[e._v("默认")]):a("span",[e._v(e._s(t.row.ttl))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"zone_name",label:"zone",width:"140px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"update_user",label:"创建用户",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"created_time",label:"创建时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.created_time.substring(0,19))+"\n        ")]}}])}),e._v(">\n      "),a("el-table-column",{attrs:{prop:"operaion",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){e.openEditDialog(t.row.domain_name,t.row.record,t.row.record_type,t.row.ttl)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){e.deleteRecord(t.row.domain_name,t.row.record,t.row.record_type)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新增域名",visible:e.addRecordVisible,width:"50%"},on:{"update:visible":function(t){e.addRecordVisible=t}}},[a("div",[a("div",{staticClass:"input-label"},[e._v("新增域名")]),e._v(" "),a("el-input",{staticClass:"large-input",attrs:{size:"large",placeholder:"新增域名"},on:{blur:e.getDefaultTTL},model:{value:e.addRecordName,callback:function(t){e.addRecordName=t},expression:"addRecordName"}}),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"large",type:"primary"},on:{click:e.addRecordSubmit}},[e._v("提交")]),e._v(" "),a("div",{staticClass:"input-div"},[a("div",{staticClass:"input-label"},[e._v("自动绑定")]),e._v(" "),a("el-checkbox",{model:{value:e.isAutoBind,callback:function(t){e.isAutoBind=t},expression:"isAutoBind"}})],1),e._v(" "),e.isAutoBind?a("div",[a("div",{staticClass:"input-div"},[a("div",{staticClass:"input-label"},[e._v("域名子网")]),e._v(" "),a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"子网域名"},model:{value:e.addRecordSubnet,callback:function(t){e.addRecordSubnet=t},expression:"addRecordSubnet"}},e._l(e.regionOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)]):e._e(),e._v(" "),e.isAutoBind?e._e():a("div",[a("div",{staticClass:"input-div"},[a("div",{staticClass:"input-label"},[e._v("记录类型")]),e._v(" "),a("el-select",{staticClass:"medium-input",model:{value:e.addRecordType,callback:function(t){e.addRecordType=t},expression:"addRecordType"}},e._l(e.recordTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-checkbox",{model:{value:e.isCheckRecord,callback:function(t){e.isCheckRecord=t},expression:"isCheckRecord"}}),e._v(" "),"CNAME"===e.addRecordType?a("span",{staticClass:"input-label"},[e._v("检查CNAME")]):e._e(),e._v(" "),"A"===e.addRecordType||"AAAA"===e.addRecordType?a("span",{staticClass:"input-label"},[e._v("检查IP")]):e._e()],1),e._v(" "),a("div",{staticClass:"input-div"},[a("div",{staticClass:"input-label"},[e._v("域名记录")]),e._v(" "),a("el-input",{staticClass:"large-input",attrs:{placeholder:"请输入域名记录"},model:{value:e.addRecordValue,callback:function(t){e.addRecordValue=t},expression:"addRecordValue"}})],1),e._v(" "),a("div",{staticClass:"input-div"},[a("div",{staticClass:"input-label"},[e._v("域名TTL")]),e._v(" "),a("el-input",{staticClass:"medium-input",attrs:{placeholder:"请输入TTL"},model:{value:e.addRecordTtl,callback:function(t){e.addRecordTtl=t},expression:"addRecordTtl"}})],1),e._v(" "),a("div",{staticClass:"input-div"},[a("div",{staticClass:"input-label"},[e._v("默认TTL")]),e._v(" "),a("el-input",{staticClass:"medium-input",attrs:{placeholder:"默认TTL",disabled:!0},model:{value:e.defaultTTL,callback:function(t){e.defaultTTL=t},expression:"defaultTTL"}})],1)])],1),e._v(" "),a("div",{staticClass:"tip"},[a("div",[e._v("说明:")]),e._v(" "),a("div",{staticStyle:{color:"red"}},[e._v("1、可添加多条A/AAAA记录，只能添加一条CNAME记录，两种记录不能并存。")]),e._v(" "),a("div",{staticStyle:{color:"red"}},[e._v("2、取消勾选检查CNMAE后可解析到第三方域名。")]),e._v(" "),a("div",{staticStyle:{color:"red"}},[e._v("3、取消勾选检查IP后可解析到非ippool中的IP。")]),e._v(" "),a("div",[e._v("4、TTL为0时，使用全局TTL配置。")]),e._v(" "),a("div",[e._v("5、自动绑定需要指定子网。")])])]),e._v(" "),a("el-dialog",{attrs:{title:"记录修改",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t}}},[a("div",[a("div",{staticClass:"input-div"},[a("div",{staticClass:"input-label"},[e._v("域名")]),e._v(" "),a("el-input",{staticClass:"large-input",attrs:{disabled:!0},model:{value:e.editName,callback:function(t){e.editName=t},expression:"editName"}})],1),e._v(" "),a("div",{staticClass:"input-div"},[a("div",{staticClass:"input-label"},[e._v("类型")]),e._v(" "),a("el-select",{staticClass:"medium-input",model:{value:e.editRecord.record_type,callback:function(t){e.$set(e.editRecord,"record_type",t)},expression:"editRecord.record_type"}},e._l(e.recordTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-checkbox",{model:{value:e.editRecord.check,callback:function(t){e.$set(e.editRecord,"check",t)},expression:"editRecord.check"}}),e._v(" "),"CNAME"===e.editRecord.record_type?a("span",{staticClass:"input-label"},[e._v("检查CNAME")]):e._e(),e._v(" "),"A"===e.editRecord.record_type||"AAAA"===e.editRecord.record_type?a("span",{staticClass:"input-label"},[e._v("检查IP")]):e._e()],1),e._v(" "),a("div",{staticClass:"input-div"},[a("div",{staticClass:"input-label"},[e._v("记录")]),e._v(" "),a("el-input",{staticClass:"large-input",attrs:{placeholder:"请输入记录"},model:{value:e.editRecord.record,callback:function(t){e.$set(e.editRecord,"record",t)},expression:"editRecord.record"}})],1),e._v(" "),a("div",{staticClass:"input-div"},[a("div",{staticClass:"input-label"},[e._v("TTL")]),e._v(" "),a("el-input",{staticClass:"large-input",attrs:{placeholder:"请输入TTL"},model:{value:e.editRecord.ttl,callback:function(t){e.$set(e.editRecord,"ttl",t)},expression:"editRecord.ttl"}})],1)]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.modifyRecord}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-div-container"},[a("div",{staticClass:"login-div"},[a("div",{staticClass:"login-title"},[e._v("登录")]),e._v(" "),a("el-form",{ref:"form",attrs:{"label-position":"top",model:e.form,"label-width":"80px",rules:e.rules}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.onSubmit(t):null}},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.onSubmit(t):null}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),a("el-form-item",[a("div",{staticClass:"login-button-div"},[a("el-button",{staticClass:"login-button",attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("登录")])],1)])],1)],1)])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tab-panel"},[a("div",[a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[a("el-input",{staticClass:"large-input",attrs:{size:"large",placeholder:"请输入ip"},on:{change:e.searchAclByIP},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchAclByIP(t):null}},model:{value:e.searchIP,callback:function(t){e.searchIP=t},expression:"searchIP"}}),e._v(" "),a("el-button",{attrs:{size:"large"},on:{click:e.searchAclByIP}},[e._v("搜索")])],1)]),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[a("el-button",{staticStyle:{display:"inline-block","margin-left":"2px"},attrs:{size:"large"},on:{click:function(t){e.addSubnetVisible=!0}}},[e._v("新增网段")])],1)])],1),e._v(" "),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.subnetLoading,expression:"subnetLoading"}],staticClass:"medium-table",attrs:{height:"500px",border:"",data:e.aclRecordList}},[a("el-table-column",{attrs:{prop:"subnet",label:"网段",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"所属运营商",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"demonstration"},[e._v(" "+e._s(e.aclIspDict[t.row.origin_acl])+" ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"当前运营商",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"demonstration"},[e._v(" "+e._s(e.aclIspDict[t.row.now_acl])+" ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.batch_locked?e._e():a("el-button",{attrs:{size:"small"},on:{click:function(a){e.showMigrateDialog(t.row.id,t.row.now_acl)}}},[e._v("\n              迁移\n            ")]),e._v(" "),t.row.now_acl!==t.row.origin_acl?a("el-button",{attrs:{size:"small"},on:{click:function(a){e.subnetIspRecover(t.row.id,t.row.origin_acl,t.row.subnet)}}},[e._v("\n              恢复\n            ")]):e._e(),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(a){e.deleteSubnet(t.row.id)}}},[e._v("\n              删除\n            ")])]}}])})],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"subnet迁移",visible:e.subnetMigrateVisible},on:{"update:visible":function(t){e.subnetMigrateVisible=t}}},[a("label",{attrs:{for:"select"}},[e._v("选择运营商")]),e._v(" "),a("el-select",{attrs:{clearable:"",placeholder:"目标运营商"},on:{change:e.handleChoiceIsp},model:{value:e.migrate2acl,callback:function(t){e.migrate2acl=t},expression:"migrate2acl"}},e._l(e.IspOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:e.migrateSubnetFrom===t.value}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))])])}),1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.migrate2acl="",e.subnetMigrateVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubnetMigrate}},[e._v("迁移")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"acl网段新增",visible:e.addSubnetVisible},on:{"update:visible":function(t){e.addSubnetVisible=t}}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"运营商"}},[a("el-select",{attrs:{clearable:""},model:{value:e.addSubnetAcl,callback:function(t){e.addSubnetAcl=t},expression:"addSubnetAcl"}},e._l(e.IspOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))])])}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"网段"}},[a("el-input",{nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.checkSubnet(t):null}},model:{value:e.addSubnet,callback:function(t){e.addSubnet=t},expression:"addSubnet"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addSubnetVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAddSubnet}},[e._v("新增")])],1)],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tab-panel"},[a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[a("el-select",{attrs:{clearable:"",size:"large",placeholder:"搜索类型"},model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},e._l(e.searchOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),"byRole"===e.searchType?a("el-select",{attrs:{clearable:"",size:"large",placeholder:"请选择角色"},on:{change:e.fetchUser},model:{value:e.searchRole,callback:function(t){e.searchRole=t},expression:"searchRole"}},e._l(e.roleOption,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1):e._e(),e._v(" "),"byUser"===e.searchType?a("el-input",{staticClass:"large-input",attrs:{size:"large",placeholder:"请输入用户名"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.fetchUser(t):null}},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}}):e._e(),e._v(" "),a("el-button",{attrs:{size:"large",type:"info"},on:{click:e.fetchUser}},[e._v("搜索")])],1)]),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content"},[a("el-button",{attrs:{size:"large",type:"info"},on:{click:function(t){e.addUserVisible=!0}}},[e._v("添加")])],1)])],1)],1),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"tab-panel"},[a("el-table",{attrs:{data:e.userList}},[a("el-table-column",{attrs:{prop:"username",label:"用户名",width:"300px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"300px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"role",label:"角色",width:"300px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.roleObj[t.row.role_id]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"opration",label:"操作",width:"300px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){e.deleteUser(t.row.username)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{align:"right",layout:"prev, pager, next","current-page":e.page,"page-size":e.pageSize,total:e.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"添加用户",visible:e.addUserVisible,width:"30%"},on:{"update:visible":function(t){e.addUserVisible=t}}},[a("el-form",{ref:"addUserForm",attrs:{"status-icon":"",model:e.addUserForm,rules:e.addUserRules,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{on:{blur:function(t){e.addUserForm.username=e.addUserForm.username.trim()}},model:{value:e.addUserForm.username,callback:function(t){e.$set(e.addUserForm,"username",t)},expression:"addUserForm.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{on:{blur:function(t){e.addUserForm.email=e.addUserForm.email.trim()}},model:{value:e.addUserForm.email,callback:function(t){e.$set(e.addUserForm,"email",t)},expression:"addUserForm.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"roleId"}},[a("el-select",{attrs:{clearable:"",size:"large",placeholder:"请选择角色"},model:{value:e.addUserForm.roleId,callback:function(t){e.$set(e.addUserForm,"roleId",t)},expression:"addUserForm.roleId"}},e._l(e.roleOption,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.addUserForm.password,callback:function(t){e.$set(e.addUserForm,"password",t)},expression:"addUserForm.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[a("el-input",{attrs:{type:"password"},model:{value:e.addUserForm.confirmPassword,callback:function(t){e.$set(e.addUserForm,"confirmPassword",t)},expression:"addUserForm.confirmPassword"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addUserVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("addUserForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"user",label:"用户管理"}},[a("UserManager")],1)],1)],1)},staticRenderFns:[]}},,,,function(e,t){}],[122]);
//# sourceMappingURL=app.8f6318bdebfe230b5a3f.js.map